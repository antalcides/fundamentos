function AlgoliaExplainResults(hit,titleAttribute,otherAttributes){function _getHitExplanationForOneAttr_recurse(obj,foundWords){var res=[];if("object"==typeof obj&&"matchedWords"in obj&&"value"in obj){for(var match=!1,j=0;j<obj.matchedWords.length;++j){var word=obj.matchedWords[j];word in foundWords||(foundWords[word]=1,match=!0)}match&&res.push(obj.value)}else if("[object Array]"===Object.prototype.toString.call(obj))for(var i=0;i<obj.length;++i){var array=_getHitExplanationForOneAttr_recurse(obj[i],foundWords);res=res.concat(array)}else if("object"==typeof obj)for(var prop in obj)obj.hasOwnProperty(prop)&&(res=res.concat(_getHitExplanationForOneAttr_recurse(obj[prop],foundWords)));return res}function _getHitExplanationForOneAttr(hit,foundWords,attr){var base=hit._highlightResult||hit;if(-1===attr.indexOf("."))return attr in base?_getHitExplanationForOneAttr_recurse(base[attr],foundWords):[];for(var array=attr.split("."),obj=base,i=0;i<array.length;++i){if("[object Array]"===Object.prototype.toString.call(obj)){for(var res=[],j=0;j<obj.length;++j)res=res.concat(_getHitExplanationForOneAttr(obj[j],foundWords,array.slice(i).join(".")));return res}if(!(array[i]in obj))return[];obj=obj[array[i]]}return _getHitExplanationForOneAttr_recurse(obj,foundWords)}var res={},foundWords={},title=_getHitExplanationForOneAttr(hit,foundWords,titleAttribute);if(res.title=title.length>0?title[0]:"",res.subtitles=[],"undefined"!=typeof otherAttributes)for(var i=0;i<otherAttributes.length;++i)for(var attr=_getHitExplanationForOneAttr(hit,foundWords,otherAttributes[i]),j=0;j<attr.length;++j)res.subtitles.push({attr:otherAttributes[i],value:attr[j]});return res}(function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function deprecate(msg,fn){function printMsg(){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}var firstTime=!0;return extend(function(){return firstTime&&(printMsg(),firstTime=!1),fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}function Language(){}function Moment(config){checkOverflow(config),extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function cloneMoment(m){var i,result={};for(i in m)m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)&&(result[i]=m[i]);return result}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)inputObject.hasOwnProperty(prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length)),m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}function loadLang(key,values){return values.abbr=key,languages[key]||(languages[key]=new Language),languages[key].set(values),languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var j,lang,next,split,i=0,get=function(k){if(!languages[k]&&hasModule)try{require("./lang/"+k)}catch(e){}return languages[k]};if(!key)return moment.fn._lang;if(!isArray(key)){if(lang=get(key))return lang;key=[key]}for(;i<key.length;){for(split=normalizeLanguage(key[i]).split("-"),j=split.length,next=normalizeLanguage(key[i+1]),next=next?next.split("-"):null;j>0;){if(lang=get(split.slice(0,j).join("-")))return lang;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return moment.fn._lang}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.lang()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.lang().invalidDate()}function expandFormat(format,lang){function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input,10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"dd":case"ddd":case"dddd":a=getLangDefinition(config._l).weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,lang;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(lang=getLangDefinition(config._l),dow=lang._week.dow,doy=lang._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return void parseISO(config);config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,lang=getLangDefinition(config._l),string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,lang).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._isPm&&config._a[HOUR]<12&&(config._a[HOUR]+=12),config._isPm===!1&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(0/0));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=extend({},config),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);input===undefined?config._d=new Date:matched?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromConfig(config)):isDate(input)?config._d=new Date(+input):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,language){if("string"==typeof input)if(isNaN(input)){if(input=language.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1e3),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<=relativeTimeThresholds.dd&&["dd",days]||days<=relativeTimeThresholds.dm&&["M"]||days<relativeTimeThresholds.dy&&["MM",round(days/30)]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=milliseconds>0,args[4]=lang,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add("d",daysToDayOfWeek),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;return null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=getLangDefinition().preparse(input)),moment.isMoment(input)?(config=cloneMoment(input),config._d=new Date(+input._d)):format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.lang().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return+this/factor}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,oldGlobalMoment,i,VERSION="2.7.0",globalScope="undefined"!=typeof global?global:this,round=Math.round,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,dd:25,dm:45,dy:345},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Language.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment.utc([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=lang,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,lang,strict){var c;return"boolean"==typeof lang&&(strict=lang,lang=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=lang,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))&&(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}),ret=new Duration(duration),moment.isDuration(input)&&input.hasOwnProperty("_lang")&&(ret._lang=input._lang),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]===undefined?!1:(relativeTimeThresholds[threshold]=limit,!0)},moment.lang=function(key,values){var r;return key?(values?loadLang(normalizeLanguage(key),values):null===values?(unloadLang(key),key="en"):languages[key]||getLangDefinition(key),r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key),r._abbr):moment.fn._lang._abbr},moment.langData=function(key){return key&&key._lang&&key._lang._abbr&&(key=key._lang._abbr),getLangDefinition(key)
},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&obj.hasOwnProperty("_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration},i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(0/0);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;return dur="string"==typeof input&&"string"==typeof val?moment.duration(isNaN(+val)?+input:+val,isNaN(+val)?val:input):"string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,1),this},subtract:function(input,val){var dur;return dur="string"==typeof input&&"string"==typeof val?moment.duration(isNaN(+val)?+input:+val,isNaN(+val)?val:input):"string"==typeof input?moment.duration(+val,input):moment.duration(input,val),addOrSubtractDurationFromMoment(this,dur,-1),this},diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.lang()),this.add({d:input-day})):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),this.startOf(units).add("isoWeek"===units?"week":units,1).subtract("ms",1)},isAfter:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units=units||"ms",+this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),this>other?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:function(input,keepTime){var offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),this._offset=input,this._isUTC=!0,offset!==input&&(!keepTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add("d",input-dayOfYear)},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==input?year:this.add("y",input-year)},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add("y",input-year)},week:function(input){var week=this.lang().week(this);return null==input?week:this.add("d",7*(input-week))},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add("d",7*(input-week))},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return null==input?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){return units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value),this},lang:function(key){return key===undefined?this._lang:(this._lang=getLangDefinition(key),this)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,years,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),data.days=days%30,months+=absRound(days/30),data.months=months%12,years=absRound(months/12),data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());return withSuffix&&(output=this.lang().pastFuture(difference,output)),this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){return units=normalizeUnits(units),this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"}});for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&(makeDurationAsGetter(i,unitMillisecondFactors[i]),makeDurationGetter(i.toLowerCase()));makeDurationAsGetter("Weeks",6048e5),moment.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},moment.lang("en",{ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}).call(this);var app=angular.module("autocomplete",[]);app.directive("autocomplete",function(){var index=-1;return{restrict:"E",scope:{searchParam:"=ngModel",suggestions:"=data",onType:"=onType",onSelect:"=onSelect"},controller:["$scope",function($scope){$scope.selectedIndex=-1,$scope.setIndex=function(i){$scope.selectedIndex=parseInt(i)},this.setIndex=function(i){$scope.setIndex(i),$scope.$apply()},$scope.getIndex=function(){return $scope.selectedIndex};var watching=!0;$scope.completing=!1,$scope.$watch("searchParam",function(newValue,oldValue){oldValue!==newValue&&(watching&&$scope.searchParam&&($scope.completing=!0,$scope.searchFilter=$scope.searchParam,$scope.selectedIndex=-1),$scope.onType&&$scope.onType($scope.searchParam))}),this.preSelect=function(){watching=!1,$scope.$apply(),watching=!0},$scope.preSelect=this.preSelect,this.preSelectOff=function(){watching=!0},$scope.preSelectOff=this.preSelectOff,$scope.select=function(suggestion){suggestion&&($scope.searchParam=suggestion,$scope.searchFilter=suggestion,$scope.onSelect&&$scope.onSelect(suggestion)),watching=!1,$scope.completing=!1,setTimeout(function(){watching=!0},1e3),$scope.setIndex(-1)}}],link:function(scope,element,attrs){var attr="";scope.attrs={placeholder:"start typing...","class":"",id:"",inputclass:"",inputid:""};for(var a in attrs)attr=a.replace("attr","").toLowerCase(),0===a.indexOf("attr")&&(scope.attrs[attr]=attrs[a]);attrs.clickActivation&&(element[0].onclick=function(){scope.searchParam||(scope.completing=!0,scope.$apply())});var key={left:37,up:38,right:39,down:40,enter:13,esc:27};document.addEventListener("keydown",function(e){var keycode=e.keyCode||e.which;switch(keycode){case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault()}},!0),document.addEventListener("blur",function(){setTimeout(function(){scope.select(),scope.setIndex(-1),scope.$apply()},200)},!0),element[0].addEventListener("keydown",function(e){var keycode=e.keyCode||e.which,l=angular.element(this).find("li").length;switch(keycode){case key.up:if(index=scope.getIndex()-1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text()),scope.$apply();break;case key.down:if(index=scope.getIndex()+1,-1>index)index=l-1;else if(index>=l){index=-1,scope.setIndex(index),scope.preSelectOff(),scope.$apply();break}scope.setIndex(index),-1!==index&&scope.preSelect(angular.element(angular.element(this).find("li")[index]).text());break;case key.left:break;case key.right:case key.enter:index=scope.getIndex(),-1!==index&&scope.select(angular.element(angular.element(this).find("li")[index]).text()),scope.setIndex(-1),scope.$apply();break;case key.esc:scope.select(),scope.setIndex(-1),scope.$apply(),e.preventDefault();break;default:return}(-1!==scope.getIndex()||keycode==key.enter)&&e.preventDefault()})},templateUrl:"js/libs/angular-autocomplete/ac_template.html"}}),app.filter("highlight",["$sce",function($sce){return function(input,searchParam){if("function"==typeof input)return"";if(searchParam){var words="("+searchParam.split(/\ /).join(" |")+"|"+searchParam.split(/\ /).join("|")+")",exp=new RegExp(words,"gi");words.length&&(input=input.replace(exp,'<span class="highlight">$1</span>'))}return $sce.trustAsHtml(input)}}]),app.directive("suggestion",function(){return{restrict:"A",require:"^autocomplete",link:function(scope,element,attrs,autoCtrl){element.bind("mouseenter",function(){autoCtrl.preSelect(attrs.val),autoCtrl.setIndex(attrs.index)}),element.bind("mouseleave",function(){autoCtrl.preSelectOff()})}}}),define("libs/angular-autocomplete/angular-autocomplete",function(){}),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});{element[0].offsetWidth}element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(index,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){accordionCtrl.addGroup(scope),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope)}),scope.toggleOpen=function(){scope.isDisabled||(scope.isOpen=!scope.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(scope,element,attr,accordionGroupCtrl,transclude){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function($scope,$attrs){$scope.closeable="close"in $attrs}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(scope,element,attr){element.addClass("ng-binding").data("$binding",attr.bindHtmlUnsafe),scope.$watch(attr.bindHtmlUnsafe,function(value){element.html(value||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(buttonConfig){this.activeClass=buttonConfig.activeClass||"active",this.toggleEvent=buttonConfig.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,scope.$eval(attrs.btnRadio)))},element.bind(buttonsCtrl.toggleEvent,function(){var isActive=element.hasClass(buttonsCtrl.activeClass);(!isActive||angular.isDefined(attrs.uncheckable))&&scope.$apply(function(){ngModelCtrl.$setViewValue(isActive?null:scope.$eval(attrs.btnRadio)),ngModelCtrl.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(scope,element,attrs,ctrls){function getTrueValue(){return getCheckboxValue(attrs.btnCheckboxTrue,!0)}function getFalseValue(){return getCheckboxValue(attrs.btnCheckboxFalse,!1)}function getCheckboxValue(attributeValue,defaultValue){var val=scope.$eval(attributeValue);return angular.isDefined(val)?val:defaultValue}var buttonsCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl.$render=function(){element.toggleClass(buttonsCtrl.activeClass,angular.equals(ngModelCtrl.$modelValue,getTrueValue()))},element.bind(buttonsCtrl.toggleEvent,function(){scope.$apply(function(){ngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass)?getFalseValue():getTrueValue()),ngModelCtrl.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function($scope,$timeout,$transition){function restartTimer(){resetTimer();var interval=+$scope.interval;!isNaN(interval)&&interval>=0&&(currentTimeout=$timeout(timerFn,interval))}function resetTimer(){currentTimeout&&($timeout.cancel(currentTimeout),currentTimeout=null)}function timerFn(){isPlaying?($scope.next(),restartTimer()):$scope.pause()}var currentTimeout,isPlaying,self=this,slides=self.slides=$scope.slides=[],currentIndex=-1;self.currentSlide=null;var destroyed=!1;self.select=$scope.select=function(nextSlide,direction){function goNext(){if(!destroyed){if(self.currentSlide&&angular.isString(direction)&&!$scope.noTransition&&nextSlide.$element){nextSlide.$element.addClass(direction);{nextSlide.$element[0].offsetWidth}angular.forEach(slides,function(slide){angular.extend(slide,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(nextSlide,{direction:direction,active:!0,entering:!0}),angular.extend(self.currentSlide||{},{direction:direction,leaving:!0}),$scope.$currentTransition=$transition(nextSlide.$element,{}),function(next,current){$scope.$currentTransition.then(function(){transitionDone(next,current)},function(){transitionDone(next,current)})}(nextSlide,self.currentSlide)}else transitionDone(nextSlide,self.currentSlide);self.currentSlide=nextSlide,currentIndex=nextIndex,restartTimer()}}function transitionDone(next,current){angular.extend(next,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(current||{},{direction:"",active:!1,leaving:!1,entering:!1}),$scope.$currentTransition=null}var nextIndex=slides.indexOf(nextSlide);void 0===direction&&(direction=nextIndex>currentIndex?"next":"prev"),nextSlide&&nextSlide!==self.currentSlide&&($scope.$currentTransition?($scope.$currentTransition.cancel(),$timeout(goNext)):goNext())},$scope.$on("$destroy",function(){destroyed=!0}),self.indexOfSlide=function(slide){return slides.indexOf(slide)},$scope.next=function(){var newIndex=(currentIndex+1)%slides.length;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"next")},$scope.prev=function(){var newIndex=0>currentIndex-1?slides.length-1:currentIndex-1;return $scope.$currentTransition?void 0:self.select(slides[newIndex],"prev")},$scope.isActive=function(slide){return self.currentSlide===slide},$scope.$watch("interval",restartTimer),$scope.$on("$destroy",resetTimer),$scope.play=function(){isPlaying||(isPlaying=!0,restartTimer())},$scope.pause=function(){$scope.noPause||(isPlaying=!1,resetTimer())},self.addSlide=function(slide,element){slide.$element=element,slides.push(slide),1===slides.length||slide.active?(self.select(slides[slides.length-1]),1==slides.length&&$scope.play()):slide.active=!1},self.removeSlide=function(slide){var index=slides.indexOf(slide);slides.splice(index,1),slides.length>0&&slide.active?self.select(index>=slides.length?slides[index-1]:slides[index]):currentIndex>index&&currentIndex--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(scope,element,attrs,carouselCtrl){carouselCtrl.addSlide(scope,element),scope.$on("$destroy",function(){carouselCtrl.removeSlide(scope)}),scope.$watch("active",function(active){active&&carouselCtrl.select(scope)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function($locale,orderByFilter){function isValid(year,month,date){return 1===month&&date>28?29===date&&(year%4===0&&year%100!==0||year%400===0):3===month||5===month||8===month||10===month?31>date:!0}this.parsers={};var formatCodeToRegex={yyyy:{regex:"\\d{4}",apply:function(value){this.year=+value}},yy:{regex:"\\d{2}",apply:function(value){this.year=+value+2e3}},y:{regex:"\\d{1,4}",apply:function(value){this.year=+value}},MMMM:{regex:$locale.DATETIME_FORMATS.MONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.MONTH.indexOf(value)}},MMM:{regex:$locale.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(value){this.month=$locale.DATETIME_FORMATS.SHORTMONTH.indexOf(value)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(value){this.month=value-1}},M:{regex:"[1-9]|1[0-2]",apply:function(value){this.month=value-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(value){this.date=+value}},EEEE:{regex:$locale.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:$locale.DATETIME_FORMATS.SHORTDAY.join("|")}};this.createParser=function(format){var map=[],regex=format.split("");return angular.forEach(formatCodeToRegex,function(data,code){var index=format.indexOf(code);if(index>-1){format=format.split(""),regex[index]="("+data.regex+")",format[index]="$";for(var i=index+1,n=index+code.length;n>i;i++)regex[i]="",format[i]="$";format=format.join(""),map.push({index:index,apply:data.apply})}}),{regex:new RegExp("^"+regex.join("")+"$"),map:orderByFilter(map,"index")}},this.parse=function(input,format){if(!angular.isString(input))return input;format=$locale.DATETIME_FORMATS[format]||format,this.parsers[format]||(this.parsers[format]=this.createParser(format));var parser=this.parsers[format],regex=parser.regex,map=parser.map,results=input.match(regex);if(results&&results.length){for(var dt,fields={year:1900,month:0,date:1,hours:0},i=1,n=results.length;n>i;i++){var mapper=map[i-1];mapper.apply&&mapper.apply.call(fields,results[i])}return isValid(fields.year,fields.month,fields.date)&&(dt=new Date(fields.year,fields.month,fields.date,fields.hours)),dt}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function($document,$window){function getStyle(el,cssprop){return el.currentStyle?el.currentStyle[cssprop]:$window.getComputedStyle?$window.getComputedStyle(el)[cssprop]:el.style[cssprop]}function isStaticPositioned(element){return"static"===(getStyle(element,"position")||"static")}var parentOffsetEl=function(element){for(var docDomEl=$document[0],offsetParent=element.offsetParent||docDomEl;offsetParent&&offsetParent!==docDomEl&&isStaticPositioned(offsetParent);)offsetParent=offsetParent.offsetParent;return offsetParent||docDomEl};return{position:function(element){var elBCR=this.offset(element),offsetParentBCR={top:0,left:0},offsetParentEl=parentOffsetEl(element[0]);offsetParentEl!=$document[0]&&(offsetParentBCR=this.offset(angular.element(offsetParentEl)),offsetParentBCR.top+=offsetParentEl.clientTop-offsetParentEl.scrollTop,offsetParentBCR.left+=offsetParentEl.clientLeft-offsetParentEl.scrollLeft);var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:elBCR.top-offsetParentBCR.top,left:elBCR.left-offsetParentBCR.left}},offset:function(element){var boundingClientRect=element[0].getBoundingClientRect();return{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||$document[0].documentElement.scrollTop),left:boundingClientRect.left+($window.pageXOffset||$document[0].documentElement.scrollLeft)}},positionElements:function(hostEl,targetEl,positionStr,appendToBody){var hostElPos,targetElWidth,targetElHeight,targetElPos,positionStrParts=positionStr.split("-"),pos0=positionStrParts[0],pos1=positionStrParts[1]||"center";hostElPos=appendToBody?this.offset(hostEl):this.position(hostEl),targetElWidth=targetEl.prop("offsetWidth"),targetElHeight=targetEl.prop("offsetHeight");var shiftWidth={center:function(){return hostElPos.left+hostElPos.width/2-targetElWidth/2},left:function(){return hostElPos.left},right:function(){return hostElPos.left+hostElPos.width}},shiftHeight={center:function(){return hostElPos.top+hostElPos.height/2-targetElHeight/2},top:function(){return hostElPos.top},bottom:function(){return hostElPos.top+hostElPos.height}};switch(pos0){case"right":targetElPos={top:shiftHeight[pos1](),left:shiftWidth[pos0]()};break;case"left":targetElPos={top:shiftHeight[pos1](),left:hostElPos.left-targetElWidth};break;case"bottom":targetElPos={top:shiftHeight[pos0](),left:shiftWidth[pos1]()};break;default:targetElPos={top:hostElPos.top-targetElHeight,left:shiftWidth[pos1]()}}return targetElPos
}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function($scope,$attrs,$parse,$interpolate,$timeout,$log,dateFilter,datepickerConfig){var self=this,ngModelCtrl={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(key,index){self[key]=angular.isDefined($attrs[key])?8>index?$interpolate($attrs[key])($scope.$parent):$scope.$parent.$eval($attrs[key]):datepickerConfig[key]}),angular.forEach(["minDate","maxDate"],function(key){$attrs[key]?$scope.$parent.$watch($parse($attrs[key]),function(value){self[key]=value?new Date(value):null,self.refreshView()}):self[key]=datepickerConfig[key]?new Date(datepickerConfig[key]):null}),$scope.datepickerMode=$scope.datepickerMode||datepickerConfig.datepickerMode,$scope.uniqueId="datepicker-"+$scope.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined($attrs.initDate)?$scope.$parent.$eval($attrs.initDate):new Date,$scope.isActive=function(dateObject){return 0===self.compare(dateObject.date,self.activeDate)?($scope.activeDateId=dateObject.uid,!0):!1},this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=function(){self.render()}},this.render=function(){if(ngModelCtrl.$modelValue){var date=new Date(ngModelCtrl.$modelValue),isValid=!isNaN(date);isValid?this.activeDate=date:$log.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),ngModelCtrl.$setValidity("date",isValid)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;ngModelCtrl.$setValidity("date-disabled",!date||this.element&&!this.isDisabled(date))}},this.createDateObject=function(date,format){var model=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;return{date:date,label:dateFilter(date,format),selected:model&&0===this.compare(date,model),disabled:this.isDisabled(date),current:0===this.compare(date,new Date)}},this.isDisabled=function(date){return this.minDate&&this.compare(date,this.minDate)<0||this.maxDate&&this.compare(date,this.maxDate)>0||$attrs.dateDisabled&&$scope.dateDisabled({date:date,mode:$scope.datepickerMode})},this.split=function(arr,size){for(var arrays=[];arr.length>0;)arrays.push(arr.splice(0,size));return arrays},$scope.select=function(date){if($scope.datepickerMode===self.minMode){var dt=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):new Date(0,0,0,0,0,0,0);dt.setFullYear(date.getFullYear(),date.getMonth(),date.getDate()),ngModelCtrl.$setViewValue(dt),ngModelCtrl.$render()}else self.activeDate=date,$scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)-1]},$scope.move=function(direction){var year=self.activeDate.getFullYear()+direction*(self.step.years||0),month=self.activeDate.getMonth()+direction*(self.step.months||0);self.activeDate.setFullYear(year,month,1),self.refreshView()},$scope.toggleMode=function(direction){direction=direction||1,$scope.datepickerMode===self.maxMode&&1===direction||$scope.datepickerMode===self.minMode&&-1===direction||($scope.datepickerMode=self.modes[self.modes.indexOf($scope.datepickerMode)+direction])},$scope.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var focusElement=function(){$timeout(function(){self.element[0].focus()},0,!1)};$scope.$on("datepicker.focus",focusElement),$scope.keydown=function(evt){var key=$scope.keys[evt.which];if(key&&!evt.shiftKey&&!evt.altKey)if(evt.preventDefault(),evt.stopPropagation(),"enter"===key||"space"===key){if(self.isDisabled(self.activeDate))return;$scope.select(self.activeDate),focusElement()}else!evt.ctrlKey||"up"!==key&&"down"!==key?(self.handleKeyDown(key,evt),self.refreshView()):($scope.toggleMode("up"===key?1:-1),focusElement())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(scope,element,attrs,ctrls){var datepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&datepickerCtrl.init(ngModelCtrl)}}}).directive("daypicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getDaysInMonth(year,month){return 1!==month||year%4!==0||year%100===0&&year%400!==0?DAYS_IN_MONTH[month]:29}function getDates(startDate,n){var dates=new Array(n),current=new Date(startDate),i=0;for(current.setHours(12);n>i;)dates[i++]=new Date(current),current.setDate(current.getDate()+1);return dates}function getISO8601WeekNumber(date){var checkDate=new Date(date);checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();return checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1}scope.showWeeks=ctrl.showWeeks,ctrl.step={months:1},ctrl.element=element;var DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ctrl._refreshView=function(){var year=ctrl.activeDate.getFullYear(),month=ctrl.activeDate.getMonth(),firstDayOfMonth=new Date(year,month,1),difference=ctrl.startingDay-firstDayOfMonth.getDay(),numDisplayedFromPreviousMonth=difference>0?7-difference:-difference,firstDate=new Date(firstDayOfMonth);numDisplayedFromPreviousMonth>0&&firstDate.setDate(-numDisplayedFromPreviousMonth+1);for(var days=getDates(firstDate,42),i=0;42>i;i++)days[i]=angular.extend(ctrl.createDateObject(days[i],ctrl.formatDay),{secondary:days[i].getMonth()!==month,uid:scope.uniqueId+"-"+i});scope.labels=new Array(7);for(var j=0;7>j;j++)scope.labels[j]={abbr:dateFilter(days[j].date,ctrl.formatDayHeader),full:dateFilter(days[j].date,"EEEE")};if(scope.title=dateFilter(ctrl.activeDate,ctrl.formatDayTitle),scope.rows=ctrl.split(days,7),scope.showWeeks){scope.weekNumbers=[];for(var weekNumber=getISO8601WeekNumber(scope.rows[0][0].date),numWeeks=scope.rows.length;scope.weekNumbers.push(weekNumber++)<numWeeks;);}},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth(),date1.getDate())-new Date(date2.getFullYear(),date2.getMonth(),date2.getDate())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getDate();if("left"===key)date-=1;else if("up"===key)date-=7;else if("right"===key)date+=1;else if("down"===key)date+=7;else if("pageup"===key||"pagedown"===key){var month=ctrl.activeDate.getMonth()+("pageup"===key?-1:1);ctrl.activeDate.setMonth(month,1),date=Math.min(getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()),date)}else"home"===key?date=1:"end"===key&&(date=getDaysInMonth(ctrl.activeDate.getFullYear(),ctrl.activeDate.getMonth()));ctrl.activeDate.setDate(date)},ctrl.refreshView()}}}]).directive("monthpicker",["dateFilter",function(dateFilter){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){ctrl.step={years:1},ctrl.element=element,ctrl._refreshView=function(){for(var months=new Array(12),year=ctrl.activeDate.getFullYear(),i=0;12>i;i++)months[i]=angular.extend(ctrl.createDateObject(new Date(year,i,1),ctrl.formatMonth),{uid:scope.uniqueId+"-"+i});scope.title=dateFilter(ctrl.activeDate,ctrl.formatMonthTitle),scope.rows=ctrl.split(months,3)},ctrl.compare=function(date1,date2){return new Date(date1.getFullYear(),date1.getMonth())-new Date(date2.getFullYear(),date2.getMonth())},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getMonth();if("left"===key)date-=1;else if("up"===key)date-=3;else if("right"===key)date+=1;else if("down"===key)date+=3;else if("pageup"===key||"pagedown"===key){var year=ctrl.activeDate.getFullYear()+("pageup"===key?-1:1);ctrl.activeDate.setFullYear(year)}else"home"===key?date=0:"end"===key&&(date=11);ctrl.activeDate.setMonth(date)},ctrl.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(scope,element,attrs,ctrl){function getStartingYear(year){return parseInt((year-1)/range,10)*range+1}var range=ctrl.yearRange;ctrl.step={years:range},ctrl.element=element,ctrl._refreshView=function(){for(var years=new Array(range),i=0,start=getStartingYear(ctrl.activeDate.getFullYear());range>i;i++)years[i]=angular.extend(ctrl.createDateObject(new Date(start+i,0,1),ctrl.formatYear),{uid:scope.uniqueId+"-"+i});scope.title=[years[0].label,years[range-1].label].join(" - "),scope.rows=ctrl.split(years,5)},ctrl.compare=function(date1,date2){return date1.getFullYear()-date2.getFullYear()},ctrl.handleKeyDown=function(key){var date=ctrl.activeDate.getFullYear();"left"===key?date-=1:"up"===key?date-=5:"right"===key?date+=1:"down"===key?date+=5:"pageup"===key||"pagedown"===key?date+=("pageup"===key?-1:1)*ctrl.step.years:"home"===key?date=getStartingYear(ctrl.activeDate.getFullYear()):"end"===key&&(date=getStartingYear(ctrl.activeDate.getFullYear())+range-1),ctrl.activeDate.setFullYear(date)},ctrl.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function($compile,$parse,$document,$position,dateFilter,dateParser,datepickerPopupConfig){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(scope,element,attrs,ngModel){function cameltoDash(string){return string.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function parseDate(viewValue){if(viewValue){if(angular.isDate(viewValue)&&!isNaN(viewValue))return ngModel.$setValidity("date",!0),viewValue;if(angular.isString(viewValue)){var date=dateParser.parse(viewValue,dateFormat)||new Date(viewValue);return isNaN(date)?void ngModel.$setValidity("date",!1):(ngModel.$setValidity("date",!0),date)}return void ngModel.$setValidity("date",!1)}return ngModel.$setValidity("date",!0),null}var dateFormat,closeOnDateSelection=angular.isDefined(attrs.closeOnDateSelection)?scope.$parent.$eval(attrs.closeOnDateSelection):datepickerPopupConfig.closeOnDateSelection,appendToBody=angular.isDefined(attrs.datepickerAppendToBody)?scope.$parent.$eval(attrs.datepickerAppendToBody):datepickerPopupConfig.appendToBody;scope.showButtonBar=angular.isDefined(attrs.showButtonBar)?scope.$parent.$eval(attrs.showButtonBar):datepickerPopupConfig.showButtonBar,scope.getText=function(key){return scope[key+"Text"]||datepickerPopupConfig[key+"Text"]},attrs.$observe("datepickerPopup",function(value){dateFormat=value||datepickerPopupConfig.datepickerPopup,ngModel.$render()});var popupEl=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");popupEl.attr({"ng-model":"date","ng-change":"dateSelection()"});var datepickerEl=angular.element(popupEl.children()[0]);attrs.datepickerOptions&&angular.forEach(scope.$parent.$eval(attrs.datepickerOptions),function(value,option){datepickerEl.attr(cameltoDash(option),value)}),angular.forEach(["minDate","maxDate"],function(key){attrs[key]&&(scope.$parent.$watch($parse(attrs[key]),function(value){scope[key]=value}),datepickerEl.attr(cameltoDash(key),key))}),attrs.dateDisabled&&datepickerEl.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),ngModel.$parsers.unshift(parseDate),scope.dateSelection=function(dt){angular.isDefined(dt)&&(scope.date=dt),ngModel.$setViewValue(scope.date),ngModel.$render(),closeOnDateSelection&&(scope.isOpen=!1,element[0].focus())},element.bind("input change keyup",function(){scope.$apply(function(){scope.date=ngModel.$modelValue})}),ngModel.$render=function(){var date=ngModel.$viewValue?dateFilter(ngModel.$viewValue,dateFormat):"";element.val(date),scope.date=parseDate(ngModel.$modelValue)};var documentClickBind=function(event){scope.isOpen&&event.target!==element[0]&&scope.$apply(function(){scope.isOpen=!1})},keydown=function(evt){scope.keydown(evt)};element.bind("keydown",keydown),scope.keydown=function(evt){27===evt.which?(evt.preventDefault(),evt.stopPropagation(),scope.close()):40!==evt.which||scope.isOpen||(scope.isOpen=!0)},scope.$watch("isOpen",function(value){value?(scope.$broadcast("datepicker.focus"),scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),$document.bind("click",documentClickBind)):$document.unbind("click",documentClickBind)}),scope.select=function(date){if("today"===date){var today=new Date;angular.isDate(ngModel.$modelValue)?(date=new Date(ngModel.$modelValue),date.setFullYear(today.getFullYear(),today.getMonth(),today.getDate())):date=new Date(today.setHours(0,0,0,0))}scope.dateSelection(date)},scope.close=function(){scope.isOpen=!1,element[0].focus()};var $popup=$compile(popupEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup),scope.$on("$destroy",function(){$popup.remove(),element.unbind("keydown",keydown),$document.unbind("click",documentClickBind)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(scope,element){element.bind("click",function(event){event.preventDefault(),event.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function($document){var openScope=null;this.open=function(dropdownScope){openScope||($document.bind("click",closeDropdown),$document.bind("keydown",escapeKeyBind)),openScope&&openScope!==dropdownScope&&(openScope.isOpen=!1),openScope=dropdownScope},this.close=function(dropdownScope){openScope===dropdownScope&&(openScope=null,$document.unbind("click",closeDropdown),$document.unbind("keydown",escapeKeyBind))};var closeDropdown=function(evt){evt&&evt.isDefaultPrevented()||openScope.$apply(function(){openScope.isOpen=!1})},escapeKeyBind=function(evt){27===evt.which&&(openScope.focusToggleElement(),closeDropdown())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function($scope,$attrs,$parse,dropdownConfig,dropdownService,$animate){var getIsOpen,self=this,scope=$scope.$new(),openClass=dropdownConfig.openClass,setIsOpen=angular.noop,toggleInvoker=$attrs.onToggle?$parse($attrs.onToggle):angular.noop;this.init=function(element){self.$element=element,$attrs.isOpen&&(getIsOpen=$parse($attrs.isOpen),setIsOpen=getIsOpen.assign,$scope.$watch(getIsOpen,function(value){scope.isOpen=!!value}))},this.toggle=function(open){return scope.isOpen=arguments.length?!!open:!scope.isOpen},this.isOpen=function(){return scope.isOpen},scope.focusToggleElement=function(){self.toggleElement&&self.toggleElement[0].focus()},scope.$watch("isOpen",function(isOpen,wasOpen){$animate[isOpen?"addClass":"removeClass"](self.$element,openClass),isOpen?(scope.focusToggleElement(),dropdownService.open(scope)):dropdownService.close(scope),setIsOpen($scope,isOpen),angular.isDefined(isOpen)&&isOpen!==wasOpen&&toggleInvoker($scope,{open:!!isOpen})}),$scope.$on("$locationChangeSuccess",function(){scope.isOpen=!1}),$scope.$on("$destroy",function(){scope.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(scope,element,attrs,dropdownCtrl){dropdownCtrl.init(element)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(scope,element,attrs,dropdownCtrl){if(dropdownCtrl){dropdownCtrl.toggleElement=element;var toggleDropdown=function(event){event.preventDefault(),element.hasClass("disabled")||attrs.disabled||scope.$apply(function(){dropdownCtrl.toggle()})};element.bind("click",toggleDropdown),element.attr({"aria-haspopup":!0,"aria-expanded":!1}),scope.$watch(dropdownCtrl.isOpen,function(isOpen){element.attr("aria-expanded",!!isOpen)}),scope.$on("$destroy",function(){element.unbind("click",toggleDropdown)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope){scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(tElement,tAttrs){return tAttrs.templateUrl||"template/modal/window.html"},link:function(scope,element,attrs){element.addClass(attrs.windowClass||""),scope.size=attrs.size,$timeout(function(){scope.animate=!0,element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,function(){modalWindow.modalScope.$destroy(),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0),checkRemoveBackdrop()})}function checkRemoveBackdrop(){if(backdropDomEl&&-1==backdropIndex()){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating,0)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&(evt.preventDefault(),$rootScope.$apply(function(){$modalStack.dismiss(modal.key,"escape key press")})))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();currBackdropIndex>=0&&!backdropDomEl&&(backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex,backdropDomEl=$compile("<div modal-backdrop></div>")(backdropScope),body.append(backdropDomEl));var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr({"template-url":modal.windowTemplateUrl,"window-class":modal.windowClass,size:modal.size,index:openedWindows.length()-1,animate:"animate"}).html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance).value;modalWindow&&(modalWindow.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance).value;modalWindow&&(modalWindow.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,windowClass:modalOptions.windowClass,windowTemplateUrl:modalOptions.windowTemplateUrl,size:modalOptions.size})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function($scope,$attrs,$parse){var self=this,ngModelCtrl={$setViewValue:angular.noop},setNumPages=$attrs.numPages?$parse($attrs.numPages).assign:angular.noop;this.init=function(ngModelCtrl_,config){ngModelCtrl=ngModelCtrl_,this.config=config,ngModelCtrl.$render=function(){self.render()},$attrs.itemsPerPage?$scope.$parent.$watch($parse($attrs.itemsPerPage),function(value){self.itemsPerPage=parseInt(value,10),$scope.totalPages=self.calculateTotalPages()}):this.itemsPerPage=config.itemsPerPage},this.calculateTotalPages=function(){var totalPages=this.itemsPerPage<1?1:Math.ceil($scope.totalItems/this.itemsPerPage);return Math.max(totalPages||0,1)},this.render=function(){$scope.page=parseInt(ngModelCtrl.$viewValue,10)||1},$scope.selectPage=function(page){$scope.page!==page&&page>0&&page<=$scope.totalPages&&(ngModelCtrl.$setViewValue(page),ngModelCtrl.$render())},$scope.getText=function(key){return $scope[key+"Text"]||self.config[key+"Text"]},$scope.noPrevious=function(){return 1===$scope.page},$scope.noNext=function(){return $scope.page===$scope.totalPages},$scope.$watch("totalItems",function(){$scope.totalPages=self.calculateTotalPages()}),$scope.$watch("totalPages",function(value){setNumPages($scope.$parent,value),$scope.page>value?$scope.selectPage(value):ngModelCtrl.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function($parse,paginationConfig){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(scope,element,attrs,ctrls){function makePage(number,text,isActive){return{number:number,text:text,active:isActive}}function getPages(currentPage,totalPages){var pages=[],startPage=1,endPage=totalPages,isMaxSized=angular.isDefined(maxSize)&&totalPages>maxSize;isMaxSized&&(rotate?(startPage=Math.max(currentPage-Math.floor(maxSize/2),1),endPage=startPage+maxSize-1,endPage>totalPages&&(endPage=totalPages,startPage=endPage-maxSize+1)):(startPage=(Math.ceil(currentPage/maxSize)-1)*maxSize+1,endPage=Math.min(startPage+maxSize-1,totalPages)));for(var number=startPage;endPage>=number;number++){var page=makePage(number,number,number===currentPage);pages.push(page)}if(isMaxSized&&!rotate){if(startPage>1){var previousPageSet=makePage(startPage-1,"...",!1);pages.unshift(previousPageSet)}if(totalPages>endPage){var nextPageSet=makePage(endPage+1,"...",!1);pages.push(nextPageSet)}}return pages}var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(ngModelCtrl){var maxSize=angular.isDefined(attrs.maxSize)?scope.$parent.$eval(attrs.maxSize):paginationConfig.maxSize,rotate=angular.isDefined(attrs.rotate)?scope.$parent.$eval(attrs.rotate):paginationConfig.rotate;scope.boundaryLinks=angular.isDefined(attrs.boundaryLinks)?scope.$parent.$eval(attrs.boundaryLinks):paginationConfig.boundaryLinks,scope.directionLinks=angular.isDefined(attrs.directionLinks)?scope.$parent.$eval(attrs.directionLinks):paginationConfig.directionLinks,paginationCtrl.init(ngModelCtrl,paginationConfig),attrs.maxSize&&scope.$parent.$watch($parse(attrs.maxSize),function(value){maxSize=parseInt(value,10),paginationCtrl.render()});var originalRender=paginationCtrl.render;paginationCtrl.render=function(){originalRender(),scope.page>0&&scope.page<=scope.totalPages&&(scope.pages=getPages(scope.page,scope.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(pagerConfig){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(scope,element,attrs,ctrls){var paginationCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&(scope.align=angular.isDefined(attrs.align)?scope.$parent.$eval(attrs.align):pagerConfig.align,paginationCtrl.init(ngModelCtrl,pagerConfig))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function snake_case(name){var regexp=/[A-Z]/g,separator="-";return name.replace(regexp,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var defaultOptions={placement:"top",animation:!0,popupDelay:0},triggerMap={mouseenter:"mouseleave",click:"click",focus:"blur"},globalOptions={};this.options=function(value){angular.extend(globalOptions,value)},this.setTriggers=function(triggers){angular.extend(triggerMap,triggers)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function($window,$compile,$timeout,$parse,$document,$position,$interpolate){return function(type,prefix,defaultTriggerShow){function getTriggers(trigger){var show=trigger||options.trigger||defaultTriggerShow,hide=triggerMap[show]||show;return{show:show,hide:hide}}var options=angular.extend({},defaultOptions,globalOptions),directiveName=snake_case(type),startSym=$interpolate.startSymbol(),endSym=$interpolate.endSymbol(),template="<div "+directiveName+'-popup title="'+startSym+"tt_title"+endSym+'" content="'+startSym+"tt_content"+endSym+'" placement="'+startSym+"tt_placement"+endSym+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var tooltipLinker=$compile(template);return function(scope,element,attrs){function toggleTooltipBind(){scope.tt_isOpen?hideTooltipBind():showTooltipBind()}function showTooltipBind(){(!hasEnableExp||scope.$eval(attrs[prefix+"Enable"]))&&(scope.tt_popupDelay?popupTimeout||(popupTimeout=$timeout(show,scope.tt_popupDelay,!1),popupTimeout.then(function(reposition){reposition()})):show()())}function hideTooltipBind(){scope.$apply(function(){hide()})}function show(){return popupTimeout=null,transitionTimeout&&($timeout.cancel(transitionTimeout),transitionTimeout=null),scope.tt_content?(createTooltip(),tooltip.css({top:0,left:0,display:"block"}),appendToBody?$document.find("body").append(tooltip):element.after(tooltip),positionTooltip(),scope.tt_isOpen=!0,scope.$digest(),positionTooltip):angular.noop}function hide(){scope.tt_isOpen=!1,$timeout.cancel(popupTimeout),popupTimeout=null,scope.tt_animation?transitionTimeout||(transitionTimeout=$timeout(removeTooltip,500)):removeTooltip()}function createTooltip(){tooltip&&removeTooltip(),tooltip=tooltipLinker(scope,function(){}),scope.$digest()}function removeTooltip(){transitionTimeout=null,tooltip&&(tooltip.remove(),tooltip=null)}var tooltip,transitionTimeout,popupTimeout,appendToBody=angular.isDefined(options.appendToBody)?options.appendToBody:!1,triggers=getTriggers(void 0),hasEnableExp=angular.isDefined(attrs[prefix+"Enable"]),positionTooltip=function(){var ttPosition=$position.positionElements(element,tooltip,scope.tt_placement,appendToBody);ttPosition.top+="px",ttPosition.left+="px",tooltip.css(ttPosition)};scope.tt_isOpen=!1,attrs.$observe(type,function(val){scope.tt_content=val,!val&&scope.tt_isOpen&&hide()}),attrs.$observe(prefix+"Title",function(val){scope.tt_title=val}),attrs.$observe(prefix+"Placement",function(val){scope.tt_placement=angular.isDefined(val)?val:options.placement}),attrs.$observe(prefix+"PopupDelay",function(val){var delay=parseInt(val,10);scope.tt_popupDelay=isNaN(delay)?options.popupDelay:delay});var unregisterTriggers=function(){element.unbind(triggers.show,showTooltipBind),element.unbind(triggers.hide,hideTooltipBind)};attrs.$observe(prefix+"Trigger",function(val){unregisterTriggers(),triggers=getTriggers(val),triggers.show===triggers.hide?element.bind(triggers.show,toggleTooltipBind):(element.bind(triggers.show,showTooltipBind),element.bind(triggers.hide,hideTooltipBind))
});var animation=scope.$eval(attrs[prefix+"Animation"]);scope.tt_animation=angular.isDefined(animation)?!!animation:options.animation,attrs.$observe(prefix+"AppendToBody",function(val){appendToBody=angular.isDefined(val)?$parse(val)(scope):appendToBody}),appendToBody&&scope.$on("$locationChangeSuccess",function(){scope.tt_isOpen&&hide()}),scope.$on("$destroy",function(){$timeout.cancel(transitionTimeout),$timeout.cancel(popupTimeout),unregisterTriggers(),removeTooltip()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function($tooltip){return $tooltip("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function($tooltip){return $tooltip("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function($tooltip){return $tooltip("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function($scope,$attrs,progressConfig){var self=this,animate=angular.isDefined($attrs.animate)?$scope.$parent.$eval($attrs.animate):progressConfig.animate;this.bars=[],$scope.max=angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):progressConfig.max,this.addBar=function(bar,element){animate||element.css({transition:"none"}),this.bars.push(bar),bar.$watch("value",function(value){bar.percent=+(100*value/$scope.max).toFixed(2)}),bar.$on("$destroy",function(){element=null,self.removeBar(bar)})},this.removeBar=function(bar){this.bars.splice(this.bars.indexOf(bar),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,element)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(scope,element,attrs,progressCtrl){progressCtrl.addBar(scope,angular.element(element.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function($scope,$attrs,ratingConfig){var ngModelCtrl={$setViewValue:angular.noop};this.init=function(ngModelCtrl_){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render,this.stateOn=angular.isDefined($attrs.stateOn)?$scope.$parent.$eval($attrs.stateOn):ratingConfig.stateOn,this.stateOff=angular.isDefined($attrs.stateOff)?$scope.$parent.$eval($attrs.stateOff):ratingConfig.stateOff;var ratingStates=angular.isDefined($attrs.ratingStates)?$scope.$parent.$eval($attrs.ratingStates):new Array(angular.isDefined($attrs.max)?$scope.$parent.$eval($attrs.max):ratingConfig.max);$scope.range=this.buildTemplateObjects(ratingStates)},this.buildTemplateObjects=function(states){for(var i=0,n=states.length;n>i;i++)states[i]=angular.extend({index:i},{stateOn:this.stateOn,stateOff:this.stateOff},states[i]);return states},$scope.rate=function(value){!$scope.readonly&&value>=0&&value<=$scope.range.length&&(ngModelCtrl.$setViewValue(value),ngModelCtrl.$render())},$scope.enter=function(value){$scope.readonly||($scope.value=value),$scope.onHover({value:value})},$scope.reset=function(){$scope.value=ngModelCtrl.$viewValue,$scope.onLeave()},$scope.onKeydown=function(evt){/(37|38|39|40)/.test(evt.which)&&(evt.preventDefault(),evt.stopPropagation(),$scope.rate($scope.value+(38===evt.which||39===evt.which?1:-1)))},this.render=function(){$scope.value=ngModelCtrl.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(scope,element,attrs,ctrls){var ratingCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&ratingCtrl.init(ngModelCtrl)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function($scope){var ctrl=this,tabs=ctrl.tabs=$scope.tabs=[];ctrl.select=function(selectedTab){angular.forEach(tabs,function(tab){tab.active&&tab!==selectedTab&&(tab.active=!1,tab.onDeselect())}),selectedTab.active=!0,selectedTab.onSelect()},ctrl.addTab=function(tab){tabs.push(tab),1===tabs.length?tab.active=!0:tab.active&&ctrl.select(tab)},ctrl.removeTab=function(tab){var index=tabs.indexOf(tab);if(tab.active&&tabs.length>1){var newActiveIndex=index==tabs.length-1?index-1:index+1;ctrl.select(tabs[newActiveIndex])}tabs.splice(index,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(scope,element,attrs){scope.vertical=angular.isDefined(attrs.vertical)?scope.$parent.$eval(attrs.vertical):!1,scope.justified=angular.isDefined(attrs.justified)?scope.$parent.$eval(attrs.justified):!1}}}).directive("tab",["$parse",function($parse){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(elm,attrs,transclude){return function(scope,elm,attrs,tabsetCtrl){scope.$watch("active",function(active){active&&tabsetCtrl.select(scope)}),scope.disabled=!1,attrs.disabled&&scope.$parent.$watch($parse(attrs.disabled),function(value){scope.disabled=!!value}),scope.select=function(){scope.disabled||(scope.active=!0)},tabsetCtrl.addTab(scope),scope.$on("$destroy",function(){tabsetCtrl.removeTab(scope)}),scope.$transcludeFn=transclude}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(scope,elm){scope.$watch("headingElement",function(heading){heading&&(elm.html(""),elm.append(heading))})}}}]).directive("tabContentTransclude",function(){function isTabHeading(node){return node.tagName&&(node.hasAttribute("tab-heading")||node.hasAttribute("data-tab-heading")||"tab-heading"===node.tagName.toLowerCase()||"data-tab-heading"===node.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(scope,elm,attrs){var tab=scope.$eval(attrs.tabContentTransclude);tab.$transcludeFn(tab.$parent,function(contents){angular.forEach(contents,function(node){isTabHeading(node)?tab.headingElement=node:elm.append(node)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function($scope,$attrs,$parse,$log,$locale,timepickerConfig){function getHoursFromTemplate(){var hours=parseInt($scope.hours,10),valid=$scope.showMeridian?hours>0&&13>hours:hours>=0&&24>hours;return valid?($scope.showMeridian&&(12===hours&&(hours=0),$scope.meridian===meridians[1]&&(hours+=12)),hours):void 0}function getMinutesFromTemplate(){var minutes=parseInt($scope.minutes,10);return minutes>=0&&60>minutes?minutes:void 0}function pad(value){return angular.isDefined(value)&&value.toString().length<2?"0"+value:value}function refresh(keyboardChange){makeValid(),ngModelCtrl.$setViewValue(new Date(selected)),updateTemplate(keyboardChange)}function makeValid(){ngModelCtrl.$setValidity("time",!0),$scope.invalidHours=!1,$scope.invalidMinutes=!1}function updateTemplate(keyboardChange){var hours=selected.getHours(),minutes=selected.getMinutes();$scope.showMeridian&&(hours=0===hours||12===hours?12:hours%12),$scope.hours="h"===keyboardChange?hours:pad(hours),$scope.minutes="m"===keyboardChange?minutes:pad(minutes),$scope.meridian=selected.getHours()<12?meridians[0]:meridians[1]}function addMinutes(minutes){var dt=new Date(selected.getTime()+6e4*minutes);selected.setHours(dt.getHours(),dt.getMinutes()),refresh()}var selected=new Date,ngModelCtrl={$setViewValue:angular.noop},meridians=angular.isDefined($attrs.meridians)?$scope.$parent.$eval($attrs.meridians):timepickerConfig.meridians||$locale.DATETIME_FORMATS.AMPMS;this.init=function(ngModelCtrl_,inputs){ngModelCtrl=ngModelCtrl_,ngModelCtrl.$render=this.render;var hoursInputEl=inputs.eq(0),minutesInputEl=inputs.eq(1),mousewheel=angular.isDefined($attrs.mousewheel)?$scope.$parent.$eval($attrs.mousewheel):timepickerConfig.mousewheel;mousewheel&&this.setupMousewheelEvents(hoursInputEl,minutesInputEl),$scope.readonlyInput=angular.isDefined($attrs.readonlyInput)?$scope.$parent.$eval($attrs.readonlyInput):timepickerConfig.readonlyInput,this.setupInputEvents(hoursInputEl,minutesInputEl)};var hourStep=timepickerConfig.hourStep;$attrs.hourStep&&$scope.$parent.$watch($parse($attrs.hourStep),function(value){hourStep=parseInt(value,10)});var minuteStep=timepickerConfig.minuteStep;$attrs.minuteStep&&$scope.$parent.$watch($parse($attrs.minuteStep),function(value){minuteStep=parseInt(value,10)}),$scope.showMeridian=timepickerConfig.showMeridian,$attrs.showMeridian&&$scope.$parent.$watch($parse($attrs.showMeridian),function(value){if($scope.showMeridian=!!value,ngModelCtrl.$error.time){var hours=getHoursFromTemplate(),minutes=getMinutesFromTemplate();angular.isDefined(hours)&&angular.isDefined(minutes)&&(selected.setHours(hours),refresh())}else updateTemplate()}),this.setupMousewheelEvents=function(hoursInputEl,minutesInputEl){var isScrollingUp=function(e){e.originalEvent&&(e=e.originalEvent);var delta=e.wheelDelta?e.wheelDelta:-e.deltaY;return e.detail||delta>0};hoursInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementHours():$scope.decrementHours()),e.preventDefault()}),minutesInputEl.bind("mousewheel wheel",function(e){$scope.$apply(isScrollingUp(e)?$scope.incrementMinutes():$scope.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(hoursInputEl,minutesInputEl){if($scope.readonlyInput)return $scope.updateHours=angular.noop,void($scope.updateMinutes=angular.noop);var invalidate=function(invalidHours,invalidMinutes){ngModelCtrl.$setViewValue(null),ngModelCtrl.$setValidity("time",!1),angular.isDefined(invalidHours)&&($scope.invalidHours=invalidHours),angular.isDefined(invalidMinutes)&&($scope.invalidMinutes=invalidMinutes)};$scope.updateHours=function(){var hours=getHoursFromTemplate();angular.isDefined(hours)?(selected.setHours(hours),refresh("h")):invalidate(!0)},hoursInputEl.bind("blur",function(){!$scope.invalidHours&&$scope.hours<10&&$scope.$apply(function(){$scope.hours=pad($scope.hours)})}),$scope.updateMinutes=function(){var minutes=getMinutesFromTemplate();angular.isDefined(minutes)?(selected.setMinutes(minutes),refresh("m")):invalidate(void 0,!0)},minutesInputEl.bind("blur",function(){!$scope.invalidMinutes&&$scope.minutes<10&&$scope.$apply(function(){$scope.minutes=pad($scope.minutes)})})},this.render=function(){var date=ngModelCtrl.$modelValue?new Date(ngModelCtrl.$modelValue):null;isNaN(date)?(ngModelCtrl.$setValidity("time",!1),$log.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(date&&(selected=date),makeValid(),updateTemplate())},$scope.incrementHours=function(){addMinutes(60*hourStep)},$scope.decrementHours=function(){addMinutes(60*-hourStep)},$scope.incrementMinutes=function(){addMinutes(minuteStep)},$scope.decrementMinutes=function(){addMinutes(-minuteStep)},$scope.toggleMeridian=function(){addMinutes(720*(selected.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(scope,element,attrs,ctrls){var timepickerCtrl=ctrls[0],ngModelCtrl=ctrls[1];ngModelCtrl&&timepickerCtrl.init(ngModelCtrl,element.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function($parse){var TYPEAHEAD_REGEXP=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(input){var match=input.match(TYPEAHEAD_REGEXP);if(!match)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+input+'".');return{itemName:match[3],source:$parse(match[4]),viewMapper:$parse(match[2]||match[1]),modelMapper:$parse(match[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function($compile,$parse,$q,$timeout,$document,$position,typeaheadParser){var HOT_KEYS=[9,13,27,38,40];return{require:"ngModel",link:function(originalScope,element,attrs,modelCtrl){var hasFocus,minSearch=originalScope.$eval(attrs.typeaheadMinLength)||1,waitTime=originalScope.$eval(attrs.typeaheadWaitMs)||0,isEditable=originalScope.$eval(attrs.typeaheadEditable)!==!1,isLoadingSetter=$parse(attrs.typeaheadLoading).assign||angular.noop,onSelectCallback=$parse(attrs.typeaheadOnSelect),inputFormatter=attrs.typeaheadInputFormatter?$parse(attrs.typeaheadInputFormatter):void 0,appendToBody=attrs.typeaheadAppendToBody?originalScope.$eval(attrs.typeaheadAppendToBody):!1,$setModelValue=$parse(attrs.ngModel).assign,parserResult=typeaheadParser.parse(attrs.typeahead),scope=originalScope.$new();originalScope.$on("$destroy",function(){scope.$destroy()});var popupId="typeahead-"+scope.$id+"-"+Math.floor(1e4*Math.random());element.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":popupId});var popUpEl=angular.element("<div typeahead-popup></div>");popUpEl.attr({id:popupId,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(attrs.typeaheadTemplateUrl)&&popUpEl.attr("template-url",attrs.typeaheadTemplateUrl);var resetMatches=function(){scope.matches=[],scope.activeIdx=-1,element.attr("aria-expanded",!1)},getMatchId=function(index){return popupId+"-option-"+index};scope.$watch("activeIdx",function(index){0>index?element.removeAttr("aria-activedescendant"):element.attr("aria-activedescendant",getMatchId(index))});var getMatchesAsync=function(inputValue){var locals={$viewValue:inputValue};isLoadingSetter(originalScope,!0),$q.when(parserResult.source(originalScope,locals)).then(function(matches){var onCurrentRequest=inputValue===modelCtrl.$viewValue;if(onCurrentRequest&&hasFocus)if(matches.length>0){scope.activeIdx=0,scope.matches.length=0;for(var i=0;i<matches.length;i++)locals[parserResult.itemName]=matches[i],scope.matches.push({id:getMatchId(i),label:parserResult.viewMapper(scope,locals),model:matches[i]});scope.query=inputValue,scope.position=appendToBody?$position.offset(element):$position.position(element),scope.position.top=scope.position.top+element.prop("offsetHeight"),element.attr("aria-expanded",!0)}else resetMatches();onCurrentRequest&&isLoadingSetter(originalScope,!1)},function(){resetMatches(),isLoadingSetter(originalScope,!1)})};resetMatches(),scope.query=void 0;var timeoutPromise;modelCtrl.$parsers.unshift(function(inputValue){return hasFocus=!0,inputValue&&inputValue.length>=minSearch?waitTime>0?(timeoutPromise&&$timeout.cancel(timeoutPromise),timeoutPromise=$timeout(function(){getMatchesAsync(inputValue)},waitTime)):getMatchesAsync(inputValue):(isLoadingSetter(originalScope,!1),resetMatches()),isEditable?inputValue:inputValue?void modelCtrl.$setValidity("editable",!1):(modelCtrl.$setValidity("editable",!0),inputValue)}),modelCtrl.$formatters.push(function(modelValue){var candidateViewValue,emptyViewValue,locals={};return inputFormatter?(locals.$model=modelValue,inputFormatter(originalScope,locals)):(locals[parserResult.itemName]=modelValue,candidateViewValue=parserResult.viewMapper(originalScope,locals),locals[parserResult.itemName]=void 0,emptyViewValue=parserResult.viewMapper(originalScope,locals),candidateViewValue!==emptyViewValue?candidateViewValue:modelValue)}),scope.select=function(activeIdx){var model,item,locals={};locals[parserResult.itemName]=item=scope.matches[activeIdx].model,model=parserResult.modelMapper(originalScope,locals),$setModelValue(originalScope,model),modelCtrl.$setValidity("editable",!0),onSelectCallback(originalScope,{$item:item,$model:model,$label:parserResult.viewMapper(originalScope,locals)}),resetMatches(),$timeout(function(){element[0].focus()},0,!1)},element.bind("keydown",function(evt){0!==scope.matches.length&&-1!==HOT_KEYS.indexOf(evt.which)&&(evt.preventDefault(),40===evt.which?(scope.activeIdx=(scope.activeIdx+1)%scope.matches.length,scope.$digest()):38===evt.which?(scope.activeIdx=(scope.activeIdx?scope.activeIdx:scope.matches.length)-1,scope.$digest()):13===evt.which||9===evt.which?scope.$apply(function(){scope.select(scope.activeIdx)}):27===evt.which&&(evt.stopPropagation(),resetMatches(),scope.$digest()))}),element.bind("blur",function(){hasFocus=!1});var dismissClickHandler=function(evt){element[0]!==evt.target&&(resetMatches(),scope.$digest())};$document.bind("click",dismissClickHandler),originalScope.$on("$destroy",function(){$document.unbind("click",dismissClickHandler)});var $popup=$compile(popUpEl)(scope);appendToBody?$document.find("body").append($popup):element.after($popup)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(scope,element,attrs){scope.templateUrl=attrs.templateUrl,scope.isOpen=function(){return scope.matches.length>0},scope.isActive=function(matchIdx){return scope.active==matchIdx},scope.selectActive=function(matchIdx){scope.active=matchIdx},scope.selectMatch=function(activeIdx){scope.select({activeIdx:activeIdx})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function($http,$templateCache,$compile,$parse){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(scope,element,attrs){var tplUrl=$parse(attrs.templateUrl)(scope.$parent)||"template/typeahead/typeahead-match.html";$http.get(tplUrl,{cache:$templateCache}).success(function(tplContent){element.replaceWith($compile(tplContent.trim())(scope))})}}}]).filter("typeaheadHighlight",function(){function escapeRegexp(queryToEscape){return queryToEscape.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(matchItem,query){return query?(""+matchItem).replace(new RegExp(escapeRegexp(query),"gi"),"<strong>$&</strong>"):matchItem}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/alert/alert.html",'<div class="alert" ng-class="{\'alert-{{type || \'warning\'}}\': true, \'alert-dismissable\': closeable}" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" ng-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')
}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset-titles.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset-titles.html","<ul class=\"nav {{type && 'nav-' + type}}\" ng-class=\"{'nav-stacked': vertical}\">\n</ul>\n")}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/tabs/tabset.html",'\n<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-if="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>')}]),define("libs/ui-bootstrap",function(){}),angular.module("ng-context-menu",[]).factory("ContextMenuService",function(){return{element:null,menuElement:null,container:null}}).directive("contextMenu",["$document","ContextMenuService",function($document,ContextMenuService){return{restrict:"A",scope:{callback:"&contextMenu",disabled:"&contextMenuDisabled"},link:function($scope,$element,$attrs){function open(event,menuElement,container){menuElement.addClass("open"),container&&container.append(menuElement);var doc=$document[0].documentElement,docLeft=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0),docTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0),elementHeight=menuElement[0].scrollHeight,docHeight=doc.clientHeight+docTop,totalHeight=elementHeight+event.pageY,top=Math.max(event.pageY-docTop,0);totalHeight>docHeight&&(top-=totalHeight-docHeight),menuElement.css("top",top+"px"),menuElement.css("left",Math.max(event.pageX-docLeft,0)+"px"),opened=!0}function close(menuElement){menuElement.removeClass("open"),opened=!1}function handleKeyUpEvent(event){!$scope.disabled()&&opened&&27===event.keyCode&&$scope.$apply(function(){close(ContextMenuService.menuElement)})}function handleClickEvent(event){$scope.disabled()||!opened||2===event.button&&event.target===ContextMenuService.element||$scope.$apply(function(){close(ContextMenuService.menuElement)})}var opened=!1;$element.bind("contextmenu",function(event){$scope.disabled()||(null!==ContextMenuService.menuElement&&close(ContextMenuService.menuElement),ContextMenuService.menuElement=angular.element(document.getElementById($attrs.target)),"undefined"!=typeof $attrs.contextMenuContainer&&(ContextMenuService.container=angular.element($attrs.contextMenuContainer)),ContextMenuService.element=event.target,event.preventDefault(),event.stopPropagation(),$scope.$apply(function(){$scope.callback({$event:event}),open(event,ContextMenuService.menuElement,ContextMenuService.container)}))}),$document.bind("keyup",handleKeyUpEvent),$document.bind("click",handleClickEvent),$document.bind("contextmenu",handleClickEvent),$scope.$on("$destroy",function(){$document.unbind("keyup",handleKeyUpEvent),$document.unbind("click",handleClickEvent),$document.unbind("contextmenu",handleClickEvent)})}}}]),define("libs/ng-context-menu-0.1.4",function(){}),function(){function eq(a,b,stack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;if(a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped),a.isEqual&&_.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&_.isFunction(b.isEqual))return b.isEqual(a);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=stack.length;length--;)if(stack[length]==a)return!0;stack.push(a);var size=0,result=!0;if("[object Array]"==className){if(size=a.length,result=size==b.length)for(;size--&&(result=size in a==size in b&&eq(a[size],b[size],stack)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],stack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return stack.pop(),result}var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return new wrapper(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.3.3";var each=_.each=_.forEach=function(obj,iterator,context){if(null!=obj)if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,l=obj.length;l>i;i++)if(i in obj&&iterator.call(context,obj[i],i,obj)===breaker)return}else for(var key in obj)if(_.has(obj,key)&&iterator.call(context,obj[key],key,obj)===breaker)return};_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results[results.length]=iterator.call(context,value,index,list)}),obj.length===+obj.length&&(results.length=obj.length),results)},_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),!initial)throw new TypeError("Reduce of empty array with no initial value");return memo},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var reversed=_.toArray(obj).reverse();return context&&!initial&&(iterator=_.bind(iterator,context)),initial?_.reduce(reversed,iterator,memo,context):_.reduce(reversed,iterator)},_.find=_.detect=function(obj,iterator,context){var result;return any(obj,function(value,index,list){return iterator.call(context,value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,iterator,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(iterator,context):(each(obj,function(value,index,list){iterator.call(context,value,index,list)&&(results[results.length]=value)}),results)},_.reject=function(obj,iterator,context){var results=[];return null==obj?results:(each(obj,function(value,index,list){iterator.call(context,value,index,list)||(results[results.length]=value)}),results)},_.every=_.all=function(obj,iterator,context){var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(iterator,context):(each(obj,function(value,index,list){return(result=result&&iterator.call(context,value,index,list))?void 0:breaker}),!!result)};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(iterator,context):(each(obj,function(value,index,list){return result||(result=iterator.call(context,value,index,list))?breaker:void 0}),!!result)};_.include=_.contains=function(obj,target){var found=!1;return null==obj?found:nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):found=any(obj,function(value){return value===target})},_.invoke=function(obj,method){var args=slice.call(arguments,2);return _.map(obj,function(value){return(_.isFunction(method)?method||value:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.max.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return-1/0;var result={computed:-1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>=result.computed&&(result={value:value,computed:computed})}),result.value},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0])return Math.min.apply(Math,obj);if(!iterator&&_.isEmpty(obj))return 1/0;var result={computed:1/0};return each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})}),result.value},_.shuffle=function(obj){var rand,shuffled=[];return each(obj,function(value,index){rand=Math.floor(Math.random()*(index+1)),shuffled[index]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sortBy=function(obj,val,context){var iterator=_.isFunction(val)?val:function(obj){return obj[val]};return _.pluck(_.map(obj,function(value,index,list){return{value:value,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;return void 0===a?1:void 0===b?-1:b>a?-1:a>b?1:0}),"value")},_.groupBy=function(obj,val){var result={},iterator=_.isFunction(val)?val:function(obj){return obj[val]};return each(obj,function(value,index){var key=iterator(value,index);(result[key]||(result[key]=[])).push(value)}),result},_.sortedIndex=function(array,obj,iterator){iterator||(iterator=_.identity);for(var low=0,high=array.length;high>low;){var mid=low+high>>1;iterator(array[mid])<iterator(obj)?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):_.isArguments(obj)?slice.call(obj):obj.toArray&&_.isFunction(obj.toArray)?obj.toArray():_.values(obj):[]},_.size=function(obj){return _.isArray(obj)?obj.length:_.keys(obj).length},_.first=_.head=_.take=function(array,n,guard){return null==n||guard?array[0]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){return null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=function(array,index,guard){return slice.call(array,null==index||guard?1:index)},_.compact=function(array){return _.filter(array,function(value){return!!value})},_.flatten=function(array,shallow){return _.reduce(array,function(memo,value){return _.isArray(value)?memo.concat(shallow?value:_.flatten(value)):(memo[memo.length]=value,memo)},[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iterator){var initial=iterator?_.map(array,iterator):array,results=[];return array.length<3&&(isSorted=!0),_.reduce(initial,function(memo,value,index){return(isSorted?_.last(memo)===value&&memo.length:_.include(memo,value))||(memo.push(value),results.push(array[index])),memo},[]),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=_.intersect=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})},_.difference=function(array){var rest=_.flatten(slice.call(arguments,1),!0);return _.filter(array,function(value){return!_.include(rest,value)})},_.zip=function(){for(var args=slice.call(arguments),length=_.max(_.pluck(args,"length")),results=new Array(length),i=0;length>i;i++)results[i]=_.pluck(args,""+i);return results},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i,l;if(isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item);for(i=0,l=array.length;l>i;i++)if(i in array&&array[i]===item)return i;return-1},_.lastIndexOf=function(array,item){if(null==array)return-1;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return array.lastIndexOf(item);for(var i=array.length;i--;)if(i in array&&array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var len=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(len);len>idx;)range[idx++]=start,start+=step;return range};var ctor=function(){};_.bind=function(func,context){var bound,args;if(func.bind===nativeBind&&nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError;return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor,result=func.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);return 0==funcs.length&&(funcs=_.functions(obj)),each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher||(hasher=_.identity),function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait){var context,args,timeout,throttling,more,result,whenDone=_.debounce(function(){more=throttling=!1},wait);return function(){context=this,args=arguments;var later=function(){timeout=null,more&&func.apply(context,args),whenDone()};return timeout||(timeout=setTimeout(later,wait)),throttling?more=!0:result=func.apply(context,args),whenDone(),throttling=!0,result}},_.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)};immediate&&!timeout&&func.apply(context,args),clearTimeout(timeout),timeout=setTimeout(later,wait)}},_.once=function(func){var memo,ran=!1;return function(){return ran?memo:(ran=!0,memo=func.apply(this,arguments))}},_.wrap=function(func,wrapper){return function(){var args=[func].concat(slice.call(arguments,0));return wrapper.apply(this,args)}},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;i>=0;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return 0>=times?func():function(){return--times<1?func.apply(this,arguments):void 0}},_.keys=nativeKeys||function(obj){if(obj!==Object(obj))throw new TypeError("Invalid object");var keys=[];for(var key in obj)_.has(obj,key)&&(keys[keys.length]=key);return keys},_.values=function(obj){return _.map(obj,_.identity)},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var result={};return each(_.flatten(slice.call(arguments,1)),function(key){key in obj&&(result[key]=obj[key])}),result},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){for(var prop in source)null==obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isEqual=function(a,b){return eq(a,b,[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!=obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},_.isArguments=function(obj){return"[object Arguments]"==toString.call(obj)},_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),_.isFunction=function(obj){return"[object Function]"==toString.call(obj)},_.isString=function(obj){return"[object String]"==toString.call(obj)},_.isNumber=function(obj){return"[object Number]"==toString.call(obj)},_.isFinite=function(obj){return _.isNumber(obj)&&isFinite(obj)},_.isNaN=function(obj){return obj!==obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"==toString.call(obj)},_.isDate=function(obj){return"[object Date]"==toString.call(obj)},_.isRegExp=function(obj){return"[object RegExp]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.times=function(n,iterator,context){for(var i=0;n>i;i++)iterator.call(context,i)},_.escape=function(string){return(""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},_.result=function(object,property){if(null==object)return null;var value=object[property];return _.isFunction(value)?value.call(object):value},_.mixin=function(obj){each(_.functions(obj),function(name){addToWrapper(name,_[name]=obj[name])})};var idCounter=0;_.uniqueId=function(prefix){var id=idCounter++;return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/.^/,escapes={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var p in escapes)escapes[escapes[p]]=p;var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g,unescaper=/\\(\\|'|r|n|t|u2028|u2029)/g,unescape=function(code){return code.replace(unescaper,function(match,escape){return escapes[escape]})};_.template=function(text,data,settings){settings=_.defaults(settings||{},_.templateSettings);var source="__p+='"+text.replace(escaper,function(match){return"\\"+escapes[match]}).replace(settings.escape||noMatch,function(match,code){return"'+\n_.escape("+unescape(code)+")+\n'"}).replace(settings.interpolate||noMatch,function(match,code){return"'+\n("+unescape(code)+")+\n'"}).replace(settings.evaluate||noMatch,function(match,code){return"';\n"+unescape(code)+"\n;__p+='"})+"';\n";settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+source+"return __p;\n";var render=new Function(settings.variable||"obj","_",source);if(data)return render(data,_);var template=function(data){return render.call(this,data,_)};return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()};var wrapper=function(obj){this._wrapped=obj};_.prototype=wrapper.prototype;var result=function(obj,chain){return chain?_(obj).chain():obj},addToWrapper=function(name,func){wrapper.prototype[name]=function(){var args=slice.call(arguments);return unshift.call(args,this._wrapped),result(func.apply(_,args),this._chain)}};_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){var wrapped=this._wrapped;method.apply(wrapped,arguments);var length=wrapped.length;return"shift"!=name&&"splice"!=name||0!==length||delete wrapped[0],result(wrapped,this._chain)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];wrapper.prototype[name]=function(){return result(method.apply(this._wrapped,arguments),this._chain)}}),wrapper.prototype.chain=function(){return this._chain=!0,this},wrapper.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),define("libs/underscore-1.3.3",function(){});var ALGOLIA_VERSION="2.5.2",AlgoliaSearch=function(applicationID,apiKey,method,resolveDNS,hostsArray){var self=this;this.applicationID=applicationID,this.apiKey=apiKey,this._isUndefined(hostsArray)&&(hostsArray=[applicationID+"-1.algolia.io",applicationID+"-2.algolia.io",applicationID+"-3.algolia.io"]),this.hosts=[];for(var i=0;i<hostsArray.length;++i)Math.random()>.5&&this.hosts.reverse(),this.hosts.push(this._isUndefined(method)||null==method?("https:"==document.location.protocol?"https":"http")+"://"+hostsArray[i]:"https"===method||"HTTPS"===method?"https://"+hostsArray[i]:"http://"+hostsArray[i]);Math.random()>.5&&this.hosts.reverse(),this.jsonp=null,this.jsonpWait=0,this._jsonRequest({method:"GET",url:"/1/isalive",callback:function(success){self.jsonp=!success}}),this.extraHeaders=[]};AlgoliaSearch.prototype={deleteIndex:function(indexName,callback){this._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(indexName),callback:callback})},moveIndex:function(srcIndexName,dstIndexName,callback){var postObj={operation:"move",destination:dstIndexName};this._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(srcIndexName)+"/operation",body:postObj,callback:callback})},copyIndex:function(srcIndexName,dstIndexName,callback){var postObj={operation:"copy",destination:dstIndexName};this._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(srcIndexName)+"/operation",body:postObj,callback:callback})},getLogs:function(callback,offset,length){this._isUndefined(offset)&&(offset=0),this._isUndefined(length)&&(length=10),this._jsonRequest({method:"GET",url:"/1/logs?offset="+offset+"&length="+length,callback:callback})},listIndexes:function(callback){this._jsonRequest({method:"GET",url:"/1/indexes",callback:callback})},initIndex:function(indexName){return new this.Index(this,indexName)},listUserKeys:function(callback){this._jsonRequest({method:"GET",url:"/1/keys",callback:callback})},getUserKeyACL:function(key,callback){this._jsonRequest({method:"GET",url:"/1/keys/"+key,callback:callback})},deleteUserKey:function(key,callback){this._jsonRequest({method:"DELETE",url:"/1/keys/"+key,callback:callback})},addUserKey:function(acls,callback){var aclsObject={};aclsObject.acl=acls,this._jsonRequest({method:"POST",url:"/1/keys",body:aclsObject,callback:callback})},addUserKeyWithValidity:function(acls,validity,maxQueriesPerIPPerHour,maxHitsPerQuery,callback){var indexObj=this,aclsObject={};aclsObject.acl=acls,aclsObject.validity=validity,aclsObject.maxQueriesPerIPPerHour=maxQueriesPerIPPerHour,aclsObject.maxHitsPerQuery=maxHitsPerQuery,this._jsonRequest({method:"POST",url:"/1/indexes/"+indexObj.indexName+"/keys",body:aclsObject,callback:callback})},setSecurityTags:function(tags){if("[object Array]"===Object.prototype.toString.call(tags)){for(var strTags=[],i=0;i<tags.length;++i)if("[object Array]"===Object.prototype.toString.call(tags[i])){for(var oredTags=[],j=0;j<tags[i].length;++j)oredTags.push(tags[i][j]);strTags.push("("+oredTags.join(",")+")")}else strTags.push(tags[i]);tags=strTags.join(",")}this.tagFilters=tags},setUserToken:function(userToken){this.userToken=userToken},startQueriesBatch:function(){this.batch=[]},addQueryInBatch:function(indexName,query,args){var params="query="+encodeURIComponent(query);this._isUndefined(args)||null==args||(params=this._getSearchParams(args,params)),this.batch.push({indexName:indexName,params:params})},clearCache:function(){this.cache={}},sendQueriesBatch:function(callback,delay){var as=this,params={requests:[],apiKey:this.apiKey,appID:this.applicationID};this.userToken&&(params["X-Algolia-UserToken"]=this.userToken),this.tagFilters&&(params["X-Algolia-TagFilters"]=this.tagFilters);for(var i=0;i<as.batch.length;++i)params.requests.push(as.batch[i]);if(window.clearTimeout(as.onDelayTrigger),!this._isUndefined(delay)&&null!=delay&&delay>0){var onDelayTrigger=window.setTimeout(function(){as._sendQueriesBatch(params,callback)},delay);as.onDelayTrigger=onDelayTrigger}else this._sendQueriesBatch(params,callback)},Index:function(algoliasearch,indexName){this.indexName=indexName,this.as=algoliasearch,this.typeAheadArgs=null,this.typeAheadValueOption=null},setExtraHeader:function(key,value){this.extraHeaders.push({key:key,value:value})},_sendQueriesBatch:function(params,callback){if(null==this.jsonp){var self=this;return void this._waitReady(function(){self._sendQueriesBatch(params,callback)})}if(this.jsonp){for(var jsonpParams="",i=0;i<params.requests.length;++i){var q="/1/indexes/"+encodeURIComponent(params.requests[i].indexName)+"?"+params.requests[i].params;jsonpParams+=i+"="+encodeURIComponent(q)+"&"}this._jsonRequest({cache:this.cache,method:"GET",jsonp:!0,url:"/1/indexes/*",body:{params:jsonpParams},callback:callback})}else this._jsonRequest({cache:this.cache,method:"POST",url:"/1/indexes/*/queries",body:params,callback:callback})},_jsonRequest:function(opts){var self=this,callback=opts.callback,cache=null,cacheID=opts.url;if(this._isUndefined(opts.body)||(cacheID=opts.url+"_body_"+JSON.stringify(opts.body)),!this._isUndefined(opts.cache)&&(cache=opts.cache,!this._isUndefined(cache[cacheID])))return void(this._isUndefined(callback)||setTimeout(function(){callback(!0,cache[cacheID])},1));var impl=function(position){var idx=0;return self._isUndefined(position)||(idx=position),self.hosts.length<=idx?void(self._isUndefined(callback)||callback(!1,{message:"Cannot contact server"})):(opts.callback=function(retry,success,res,body){success||self._isUndefined(body)||window.console&&console.log("Error: "+body.message),success&&!self._isUndefined(opts.cache)&&(cache[cacheID]=body),!success&&retry&&idx+1<self.hosts.length?impl(idx+1):self._isUndefined(callback)||callback(success,body)},opts.hostname=self.hosts[idx],void self._jsonRequestByHost(opts))};impl()},_jsonRequestByHost:function(opts){var self=this,url=opts.hostname+opts.url;if(this.jsonp){if(!opts.jsonp)return void opts.callback(!0,!1,null,{message:"Method "+opts.method+" "+url+" is not supported by JSONP."});this.jsonpCounter=this.jsonpCounter||0,this.jsonpCounter+=1;var cb="algoliaJSONP_"+this.jsonpCounter;window[cb]=function(data){opts.callback(!1,!0,null,data);try{delete window[cb]}catch(e){window[cb]=void 0}};var script=document.createElement("script");script.type="text/javascript",script.src=url+"?callback="+cb+","+this.applicationID+","+this.apiKey,opts["X-Algolia-TagFilters"]&&(script.src+="&X-Algolia-TagFilters="+opts["X-Algolia-TagFilters"]),opts["X-Algolia-UserToken"]&&(script.src+="&X-Algolia-UserToken="+opts["X-Algolia-UserToken"]),opts.body&&opts.body.params&&(script.src+="&"+opts.body.params);var head=document.getElementsByTagName("head")[0];script.onerror=function(){opts.callback(!0,!1,null,{message:"Failed to load JSONP script."}),head.removeChild(script);try{delete window[cb]}catch(e){window[cb]=void 0}};var done=!1;script.onload=script.onreadystatechange=function(){if(!(done||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState)){if(done=!0,"undefined"==typeof window[cb+"_loaded"]){opts.callback(!0,!1,null,{message:"Failed to load JSONP script."});try{delete window[cb]}catch(e){window[cb]=void 0}}else try{delete window[cb+"_loaded"]}catch(e){window[cb+"_loaded"]=void 0}script.onload=script.onreadystatechange=null,head.removeChild(script)}},head.appendChild(script)}else{var body=null;this._isUndefined(opts.body)||(body=JSON.stringify(opts.body));var xmlHttp=window.XMLHttpRequest?new XMLHttpRequest:{};if("withCredentials"in xmlHttp){xmlHttp.open(opts.method,url,!0),xmlHttp.setRequestHeader("X-Algolia-API-Key",this.apiKey),xmlHttp.setRequestHeader("X-Algolia-Application-Id",this.applicationID);for(var i=0;i<this.extraHeaders.length;++i)xmlHttp.setRequestHeader(this.extraHeaders[i].key,this.extraHeaders[i].value);null!=body&&xmlHttp.setRequestHeader("Content-type","application/json")}else{if("undefined"==typeof XDomainRequest)return window.console&&console.log("Your browser is too old to support CORS requests"),void opts.callback(!1,!1,null,{message:"CORS not supported"});xmlHttp=new XDomainRequest,xmlHttp.open(opts.method,url)}xmlHttp.send(body),xmlHttp.onload=function(event){if(self._isUndefined(event)||null==event.target)opts.callback(!1,!0,event,JSON.parse(xmlHttp.responseText));
else{var retry=0===event.target.status||503===event.target.status,success=200===event.target.status||201===event.target.status;opts.callback(retry,success,event.target,null!=event.target.response?JSON.parse(event.target.response):null)}},xmlHttp.onerror=function(event){opts.callback(!0,!1,null,{message:"Could not connect to host",error:event})}}},_waitReady:function(cb){null==this.jsonp&&(this.jsonpWait+=100,this.jsonpWait>2e3&&(this.jsonp=!0),setTimeout(cb,100))},_getSearchParams:function(args,params){if(this._isUndefined(args)||null==args)return params;for(var key in args)null!=key&&args.hasOwnProperty(key)&&(params+=0===params.length?"?":"&",params+=key+"="+encodeURIComponent("[object Array]"===Object.prototype.toString.call(args[key])?JSON.stringify(args[key]):args[key]));return params},_isUndefined:function(obj){return void 0===obj},applicationID:null,apiKey:null,tagFilters:null,userToken:null,hosts:[],cache:{},extraHeaders:[]},AlgoliaSearch.prototype.Index.prototype={clearCache:function(){this.cache={}},addObject:function(content,callback,objectID){var indexObj=this;this.as._jsonRequest(this.as._isUndefined(objectID)?{method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName),body:content,callback:callback}:{method:"PUT",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/"+encodeURIComponent(objectID),body:content,callback:callback})},addObjects:function(objects,callback){for(var indexObj=this,postObj={requests:[]},i=0;i<objects.length;++i){var request={action:"addObject",body:objects[i]};postObj.requests.push(request)}this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/batch",body:postObj,callback:callback})},getObject:function(objectID,callback,attributes){if(null==this.as.jsonp){var self=this;return void this.as._waitReady(function(){self.getObject(objectID,callback,attributes)})}var indexObj=this,params="";if(!this.as._isUndefined(attributes)){params="?attributes=";for(var i=0;i<attributes.length;++i)0!==i&&(params+=","),params+=attributes[i]}this.as._jsonRequest({method:"GET",jsonp:!0,url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/"+encodeURIComponent(objectID)+params,callback:callback})},partialUpdateObject:function(partialObject,callback){var indexObj=this;this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/"+encodeURIComponent(partialObject.objectID)+"/partial",body:partialObject,callback:callback})},partialUpdateObjects:function(objects,callback){for(var indexObj=this,postObj={requests:[]},i=0;i<objects.length;++i){var request={action:"partialUpdateObject",objectID:objects[i].objectID,body:objects[i]};postObj.requests.push(request)}this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/batch",body:postObj,callback:callback})},saveObject:function(object,callback){var indexObj=this;this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/"+encodeURIComponent(object.objectID),body:object,callback:callback})},saveObjects:function(objects,callback){for(var indexObj=this,postObj={requests:[]},i=0;i<objects.length;++i){var request={action:"updateObject",objectID:objects[i].objectID,body:objects[i]};postObj.requests.push(request)}this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/batch",body:postObj,callback:callback})},deleteObject:function(objectID,callback){if(null==objectID||0===objectID.length)return void callback(!1,{message:"empty objectID"});var indexObj=this;this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/"+encodeURIComponent(objectID),callback:callback})},search:function(query,callback,args,delay){var indexObj=this,params="query="+encodeURIComponent(query);if(this.as._isUndefined(args)||null==args||(params=this.as._getSearchParams(args,params)),window.clearTimeout(indexObj.onDelayTrigger),!this.as._isUndefined(delay)&&null!=delay&&delay>0){var onDelayTrigger=window.setTimeout(function(){indexObj._search(params,callback)},delay);indexObj.onDelayTrigger=onDelayTrigger}else this._search(params,callback)},browse:function(page,callback,hitsPerPage){var indexObj=this,params="?page="+page;_.isUndefined(hitsPerPage)||(params+="&hitsPerPage="+hitsPerPage),this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/browse"+params,callback:callback})},ttAdapter:function(params){var self=this;return function(query,cb){self.search(query,function(success,content){success&&cb(content.hits)},params)}},waitTask:function(taskID,callback){var indexObj=this;this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/task/"+taskID,callback:function(success,body){success?"published"===body.status?callback(!0,body):setTimeout(function(){indexObj.waitTask(taskID,callback)},100):callback(!1,body)}})},clearIndex:function(callback){var indexObj=this;this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/clear",callback:callback})},getSettings:function(callback){var indexObj=this;this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/settings",callback:callback})},setSettings:function(settings,callback){var indexObj=this;this.as._jsonRequest({method:"PUT",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/settings",body:settings,callback:callback})},listUserKeys:function(callback){var indexObj=this;this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/keys",callback:callback})},getUserKeyACL:function(key,callback){var indexObj=this;this.as._jsonRequest({method:"GET",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/keys/"+key,callback:callback})},deleteUserKey:function(key,callback){var indexObj=this;this.as._jsonRequest({method:"DELETE",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/keys/"+key,callback:callback})},addUserKey:function(acls,callback){var indexObj=this,aclsObject={};aclsObject.acl=acls,this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/keys",body:aclsObject,callback:callback})},addUserKeyWithValidity:function(acls,validity,maxQueriesPerIPPerHour,maxHitsPerQuery,callback){var indexObj=this,aclsObject={};aclsObject.acl=acls,aclsObject.validity=validity,aclsObject.maxQueriesPerIPPerHour=maxQueriesPerIPPerHour,aclsObject.maxHitsPerQuery=maxHitsPerQuery,this.as._jsonRequest({method:"POST",url:"/1/indexes/"+encodeURIComponent(indexObj.indexName)+"/keys",body:aclsObject,callback:callback})},_search:function(params,callback){if(null==this.as.jsonp){var self=this;return void this.as._waitReady(function(){self._search(params,callback)})}var pObj={params:params,apiKey:this.as.apiKey,appID:this.as.applicationID};this.as.tagFilters&&(pObj["X-Algolia-TagFilters"]=this.as.tagFilters),this.as.userToken&&(pObj["X-Algolia-UserToken"]=this.as.userToken),this.as._jsonRequest(this.as.jsonp?{cache:this.cache,method:"GET",jsonp:!0,url:"/1/indexes/"+encodeURIComponent(this.indexName),body:pObj,callback:callback}:{cache:this.cache,method:"POST",url:"/1/indexes/"+encodeURIComponent(this.indexName)+"/query",body:pObj,callback:callback})},as:null,indexName:null,cache:{},typeAheadArgs:null,typeAheadValueOption:null,emptyConstructor:function(){}},function(){var extend=function(out){out=out||{};for(var i=1;i<arguments.length;i++)if(arguments[i])for(var key in arguments[i])arguments[i].hasOwnProperty(key)&&(out[key]=arguments[i][key]);return out};window.AlgoliaSearchHelper=function(client,index,options){var defaults={facets:[],disjunctiveFacets:[],hitsPerPage:20};this.init(client,index,extend({},defaults,options))},AlgoliaSearchHelper.prototype={init:function(client,index,options){this.client=client,this.index=index,this.options=options,this.page=0,this.refinements={},this.disjunctiveRefinements={}},search:function(q,searchCallback,searchParams){this.q=q,this.searchCallback=searchCallback,this.searchParams=searchParams||{},this.page=this.page||0,this.refinements=this.refinements||{},this.disjunctiveRefinements=this.disjunctiveRefinements||{},this._search()},clearRefinements:function(){this.disjunctiveRefinements={},this.refinements={}},addDisjunctiveRefine:function(facet,value){this.disjunctiveRefinements=this.disjunctiveRefinements||{},this.disjunctiveRefinements[facet]=this.disjunctiveRefinements[facet]||{},this.disjunctiveRefinements[facet][value]=!0},removeDisjunctiveRefine:function(facet,value){this.disjunctiveRefinements=this.disjunctiveRefinements||{},this.disjunctiveRefinements[facet]=this.disjunctiveRefinements[facet]||{};try{delete this.disjunctiveRefinements[facet][value]}catch(e){this.disjunctiveRefinements[facet][value]=void 0}},addRefine:function(facet,value){var refinement=facet+":"+value;this.refinements=this.refinements||{},this.refinements[refinement]=!0},removeRefine:function(facet,value){var refinement=facet+":"+value;this.refinements=this.refinements||{},this.refinements[refinement]=!1},toggleRefine:function(facet,value){for(var i=0;i<this.options.facets.length;++i)if(this.options.facets[i]==facet){var refinement=facet+":"+value;return this.refinements[refinement]=!this.refinements[refinement],this.page=0,this._search(),!0}this.disjunctiveRefinements[facet]=this.disjunctiveRefinements[facet]||{};for(var j=0;j<this.options.disjunctiveFacets.length;++j)if(this.options.disjunctiveFacets[j]==facet)return this.disjunctiveRefinements[facet][value]=!this.disjunctiveRefinements[facet][value],this.page=0,this._search(),!0;return!1},isRefined:function(facet,value){var refinement=facet+":"+value;return this.refinements[refinement]?!0:this.disjunctiveRefinements[facet]&&this.disjunctiveRefinements[facet][value]?!0:!1},nextPage:function(){this._gotoPage(this.page+1)},previousPage:function(){this.page>0&&this._gotoPage(this.page-1)},gotoPage:function(page){this._gotoPage(page)},setPage:function(page){this.page=page},_gotoPage:function(page){this.page=page,this._search()},_search:function(){this.client.startQueriesBatch(),this.client.addQueryInBatch(this.index,this.q,this._getHitsSearchParams());for(var i=0;i<this.options.disjunctiveFacets.length;++i)this.client.addQueryInBatch(this.index,this.q,this._getDisjunctiveFacetSearchParams(this.options.disjunctiveFacets[i]));var self=this;this.client.sendQueriesBatch(function(success,content){if(!success)return void self.searchCallback(!1,content);var aggregatedAnswer=content.results[0];aggregatedAnswer.disjunctiveFacets={},aggregatedAnswer.facetStats={};for(var i=1;i<content.results.length;++i){for(var facet in content.results[i].facets)if(aggregatedAnswer.disjunctiveFacets[facet]=content.results[i].facets[facet],self.disjunctiveRefinements[facet])for(var value in self.disjunctiveRefinements[facet])!aggregatedAnswer.disjunctiveFacets[facet][value]&&self.disjunctiveRefinements[facet][value]&&(aggregatedAnswer.disjunctiveFacets[facet][value]=0);for(var stats in content.results[i].facets_stats)aggregatedAnswer.facetStats[stats]=content.results[i].facets_stats[stats]}self.searchCallback(!0,aggregatedAnswer)})},_getHitsSearchParams:function(){return extend({},{hitsPerPage:this.options.hitsPerPage,page:this.page,facets:this.options.facets,facetFilters:this._getFacetFilters()},this.searchParams)},_getDisjunctiveFacetSearchParams:function(facet){return extend({},this.searchParams,{hitsPerPage:1,page:0,facets:facet,facetFilters:this._getFacetFilters(facet)})},_getFacetFilters:function(facet){var facetFilters=[];for(var refinement in this.refinements)this.refinements[refinement]&&facetFilters.push(refinement);for(var disjunctiveRefinement in this.disjunctiveRefinements)if(disjunctiveRefinement!=facet){var refinements=[];for(var value in this.disjunctiveRefinements[disjunctiveRefinement])this.disjunctiveRefinements[disjunctiveRefinement][value]&&refinements.push(disjunctiveRefinement+":"+value);refinements.length>0&&facetFilters.push(refinements)}return facetFilters}}}(),"object"!=typeof JSON&&(JSON={}),function(){function f(n){return 10>n?"0"+n:n}function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;length>i;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;length>i;i+=1)"string"==typeof rep[i]&&(k=rep[i],v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;space>i;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("libs/algolia-2.5.2",function(){}),function($,window,document){$.map(["localStorage","sessionStorage"],function(method){var defaults={cookiePrefix:"fallback:"+method+":",cookieOptions:{path:"/",domain:document.domain,expires:"localStorage"===method?{expires:365}:void 0}};try{$.support[method]=method in window&&null!==window[method]}catch(e){$.support[method]=!1}$[method]=function(key,value){var options=$.extend({},defaults,$[method].options);return this.getItem=function(key){var returns=function(key){return JSON.parse($.support[method]?window[method].getItem(key):$.cookie(options.cookiePrefix+key))};if("string"==typeof key)return returns(key);for(var arr=[],i=key.length;i--;)arr[i]=returns(key[i]);return arr},this.setItem=function(key,value){return value=JSON.stringify(value),$.support[method]?window[method].setItem(key,value):$.cookie(options.cookiePrefix+key,value,options.cookieOptions)},this.removeItem=function(key){return $.support[method]?window[method].removeItem(key):$.cookie(options.cookiePrefix+key,null,$.extend(options.cookieOptions,{expires:-1}))},this.clear=function(){if($.support[method])return window[method].clear();var reg=new RegExp("^"+options.cookiePrefix,""),opts=$.extend(options.cookieOptions,{expires:-1});document.cookie&&""!==document.cookie&&$.map(document.cookie.split(";"),function(cookie){reg.test(cookie=$.trim(cookie))&&$.cookie(cookie.substr(0,cookie.indexOf("=")),null,opts)})},"undefined"!=typeof key?"undefined"!=typeof value?null===value?this.removeItem(key):this.setItem(key,value):this.getItem(key):this},$[method].options=defaults})}(jQuery,window,document),define("libs/jquery.storage",function(){});var qq=function(element){return{hide:function(){return element.style.display="none",this},attach:function(type,fn){return element.addEventListener?element.addEventListener(type,fn,!1):element.attachEvent&&element.attachEvent("on"+type,fn),function(){qq(element).detach(type,fn)}},detach:function(type,fn){return element.removeEventListener?element.removeEventListener(type,fn,!1):element.attachEvent&&element.detachEvent("on"+type,fn),this},contains:function(descendant){return element===descendant?!0:element.contains?element.contains(descendant):!!(8&descendant.compareDocumentPosition(element))},insertBefore:function(elementB){return elementB.parentNode.insertBefore(element,elementB),this},remove:function(){return element.parentNode.removeChild(element),this},css:function(styles){return null!==styles.opacity&&"string"!=typeof element.style.opacity&&"undefined"!=typeof element.filters&&(styles.filter="alpha(opacity="+Math.round(100*styles.opacity)+")"),qq.extend(element.style,styles),this},hasClass:function(name){var re=new RegExp("(^| )"+name+"( |$)");return re.test(element.className)},addClass:function(name){return qq(element).hasClass(name)||(element.className+=" "+name),this},removeClass:function(name){var re=new RegExp("(^| )"+name+"( |$)");return element.className=element.className.replace(re," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(className){var candidates,result=[];return element.querySelectorAll?element.querySelectorAll("."+className):(candidates=element.getElementsByTagName("*"),qq.each(candidates,function(idx,val){qq(val).hasClass(className)&&result.push(val)}),result)},children:function(){for(var children=[],child=element.firstChild;child;)1===child.nodeType&&children.push(child),child=child.nextSibling;return children},setText:function(text){return element.innerText=text,element.textContent=text,this},clearText:function(){return qq(element).setText("")}}};qq.log=function(message,level){window.console&&(level&&"info"!==level?window.console[level]?window.console[level](message):window.console.log("<"+level+"> "+message):window.console.log(message))},qq.isObject=function(variable){return null!==variable&&variable&&"object"==typeof variable&&variable.constructor===Object},qq.isFunction=function(variable){return"function"==typeof variable},qq.trimStr=function(string){return String.prototype.trim?string.trim():string.replace(/^\s+|\s+$/g,"")},qq.isFileOrInput=function(maybeFileOrInput){if(qq.isBlob(maybeFileOrInput)&&window.File&&maybeFileOrInput instanceof File)return!0;if(window.HTMLInputElement){if(maybeFileOrInput instanceof HTMLInputElement&&maybeFileOrInput.type&&"file"===maybeFileOrInput.type.toLowerCase())return!0}else if(maybeFileOrInput.tagName&&"input"===maybeFileOrInput.tagName.toLowerCase()&&maybeFileOrInput.type&&"file"===maybeFileOrInput.type.toLowerCase())return!0;return!1},qq.isBlob=function(maybeBlob){return window.Blob&&maybeBlob instanceof Blob},qq.isXhrUploadSupported=function(){var input=document.createElement("input");return input.type="file",void 0!==input.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload},qq.isFolderDropSupported=function(dataTransfer){return dataTransfer.items&&dataTransfer.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){return!qq.android()&&qq.isXhrUploadSupported()&&(File.prototype.slice||File.prototype.webkitSlice||File.prototype.mozSlice)},qq.extend=function(first,second,extendNested){qq.each(second,function(prop,val){extendNested&&qq.isObject(val)?(void 0===first[prop]&&(first[prop]={}),qq.extend(first[prop],val,!0)):first[prop]=val})},qq.indexOf=function(arr,elt,from){if(arr.indexOf)return arr.indexOf(elt,from);from=from||0;var len=arr.length;for(0>from&&(from+=len);len>from;from+=1)if(arr.hasOwnProperty(from)&&arr[from]===elt)return from;return-1},qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})},qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")},qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=function(){var div=document.createElement("div");return function(html){div.innerHTML=html;var element=div.firstChild;return div.removeChild(element),element}}(),qq.each=function(obj,callback){var key,retVal;if(obj)for(key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&(retVal=callback(key,obj[key]),retVal===!1))break},qq.obj2url=function(obj,temp,prefixDone){var i,len,uristrings=[],prefix="&",add=function(nextObj,i){var nextTemp=temp?/\[\]$/.test(temp)?temp:temp+"["+i+"]":i;"undefined"!==nextTemp&&"undefined"!==i&&uristrings.push("object"==typeof nextObj?qq.obj2url(nextObj,nextTemp,!0):"[object Function]"===Object.prototype.toString.call(nextObj)?encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj()):encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj))};if(!prefixDone&&temp)prefix=/\?/.test(temp)?/\?$/.test(temp)?"":"&":"?",uristrings.push(temp),uristrings.push(qq.obj2url(obj));else if("[object Array]"===Object.prototype.toString.call(obj)&&"undefined"!=typeof obj)for(i=-1,len=obj.length;len>i;i+=1)add(obj[i],i);else if("undefined"!=typeof obj&&null!==obj&&"object"==typeof obj)for(i in obj)obj.hasOwnProperty(i)&&add(obj[i],i);else uristrings.push(encodeURIComponent(temp)+"="+encodeURIComponent(obj));return temp?uristrings.join(prefix):uristrings.join(prefix).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(obj,formData,arrayKeyName){return formData||(formData=new FormData),qq.each(obj,function(key,val){key=arrayKeyName?arrayKeyName+"["+key+"]":key,qq.isObject(val)?qq.obj2FormData(val,formData,key):qq.isFunction(val)?formData.append(key,val()):formData.append(key,val)}),formData},qq.obj2Inputs=function(obj,form){var input;return form||(form=document.createElement("form")),qq.obj2FormData(obj,{append:function(key,val){input=document.createElement("input"),input.setAttribute("name",key),input.setAttribute("value",val),form.appendChild(input)}}),form},qq.setCookie=function(name,value,days){var date=new Date,expires="";days&&(date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toGMTString()),document.cookie=name+"="+value+expires+"; path=/"},qq.getCookie=function(name){for(var c,nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}},qq.getCookieNames=function(regexp){var cookies=document.cookie.split(";"),cookieNames=[];return qq.each(cookies,function(idx,cookie){cookie=qq.trimStr(cookie);var equalsIdx=cookie.indexOf("=");cookie.match(regexp)&&cookieNames.push(cookie.substr(0,equalsIdx))}),cookieNames},qq.deleteCookie=function(name){qq.setCookie(name,"",-1)},qq.areCookiesEnabled=function(){var randNum=1e5*Math.random(),name="qqCookieTest:"+randNum;return qq.setCookie(name,1),qq.getCookie(name)?(qq.deleteCookie(name),!0):!1},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.DisposeSupport=function(){var disposers=[];return{dispose:function(){var disposer;do disposer=disposers.shift(),disposer&&disposer();while(disposer)},attach:function(){var args=arguments;this.addDisposer(qq(args[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(disposeFunction){disposers.push(disposeFunction)}}},qq.UploadButton=function(o){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,o),this._disposeSupport=new qq.DisposeSupport,this._element=this._options.element,qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq(this._input).remove(),qq(this._element).removeClass(this._options.focusClass),this._input=this._createInput()},_createInput:function(){var input=document.createElement("input");this._options.multiple&&input.setAttribute("multiple","multiple"),this._options.acceptFiles&&input.setAttribute("accept",this._options.acceptFiles),input.setAttribute("type","file"),input.setAttribute("name",this._options.name),qq(input).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(input);var self=this;return this._disposeSupport.attach(input,"change",function(){self._options.onChange(input)}),this._disposeSupport.attach(input,"mouseover",function(){qq(self._element).addClass(self._options.hoverClass)}),this._disposeSupport.attach(input,"mouseout",function(){qq(self._element).removeClass(self._options.hoverClass)}),this._disposeSupport.attach(input,"focus",function(){qq(self._element).addClass(self._options.focusClass)}),this._disposeSupport.attach(input,"blur",function(){qq(self._element).removeClass(self._options.focusClass)}),window.attachEvent&&input.setAttribute("tabIndex","-1"),input}},qq.FineUploaderBasic=function(o){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},paramsInBody:!0,customHeaders:{},forceMultipart:!0,inputName:"qqfile",uuidName:"qquuid",totalFileSizeName:"qqtotalfilesize"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onResume:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidateBatch:function(){},onValidate:function(){},onSubmitDelete:function(){},onDelete:function(){},onDeleteComplete:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(fileOrBlobName){return fileOrBlobName.length>33&&(fileOrBlobName=fileOrBlobName.slice(0,19)+"..."+fileOrBlobName.slice(-14)),fileOrBlobName},text:{sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1},blobs:{defaultName:"Misc data",paramNames:{name:"qqblobname"}}},qq.extend(this._options,o,!0),this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._filesInProgress=[],this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._paramsStore=this._createParamsStore("request"),this._deleteFileParamsStore=this._createParamsStore("deleteFile"),this._endpointStore=this._createEndpointStore("request"),this._deleteFileEndpointStore=this._createEndpointStore("deleteFile"),this._handler=this._createUploadHandler(),this._deleteHandler=this._createDeleteHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FineUploaderBasic.prototype={log:function(str,level){!this._options.debug||level&&"info"!==level?level&&"info"!==level&&qq.log("[FineUploader] "+str,level):qq.log("[FineUploader] "+str)},setParams:function(params,id){null==id?this._options.request.params=params:this._paramsStore.setParams(params,id)},setDeleteFileParams:function(params,id){null==id?this._options.deleteFile.params=params:this._deleteFileParamsStore.setParams(params,id)},setEndpoint:function(endpoint,id){null==id?this._options.request.endpoint=endpoint:this._endpointStore.setEndpoint(endpoint,id)},getInProgress:function(){return this._filesInProgress.length},uploadStoredFiles:function(){for(var idToUpload;this._storedIds.length;)idToUpload=this._storedIds.shift(),this._filesInProgress.push(idToUpload),this._handler.upload(idToUpload)},clearStoredFiles:function(){this._storedIds=[]},retry:function(id){return this._onBeforeManualRetry(id)?(this._handler.retry(id),!0):!1},cancel:function(id){this._handler.cancel(id)},cancelAll:function(){var storedIdsCopy=[],self=this;qq.extend(storedIdsCopy,this._storedIds),qq.each(storedIdsCopy,function(idx,storedFileId){self.cancel(storedFileId)}),this._handler.cancelAll()},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._filesInProgress=[],this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._button.reset(),this._paramsStore.reset(),this._endpointStore.reset()},addFiles:function(filesBlobDataOrInputs){var index,fileOrInput,self=this,verifiedFilesOrInputs=[];if(filesBlobDataOrInputs){for(window.FileList&&filesBlobDataOrInputs instanceof FileList||(filesBlobDataOrInputs=[].concat(filesBlobDataOrInputs)),index=0;index<filesBlobDataOrInputs.length;index+=1)fileOrInput=filesBlobDataOrInputs[index],qq.isFileOrInput(fileOrInput)?verifiedFilesOrInputs.push(fileOrInput):self.log(fileOrInput+" is not a File or INPUT element!  Ignoring!","warn");this.log("Processing "+verifiedFilesOrInputs.length+" files or inputs..."),this._uploadFileOrBlobDataList(verifiedFilesOrInputs)}},addBlobs:function(blobDataOrArray){if(blobDataOrArray){var blobDataArray=[].concat(blobDataOrArray),verifiedBlobDataList=[],self=this;qq.each(blobDataArray,function(idx,blobData){qq.isBlob(blobData)&&!qq.isFileOrInput(blobData)?verifiedBlobDataList.push({blob:blobData,name:self._options.blobs.defaultName}):qq.isObject(blobData)&&blobData.blob&&blobData.name?verifiedBlobDataList.push(blobData):self.log("addBlobs: entry at index "+idx+" is not a Blob or a BlobData object","error")
}),this._uploadFileOrBlobDataList(verifiedBlobDataList)}else this.log("undefined or non-array parameter passed into addBlobs","error")},getUuid:function(id){return this._handler.getUuid(id)},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(id){return this._handler.getSize(id)},getFile:function(fileOrBlobId){return this._handler.getFile(fileOrBlobId)},deleteFile:function(id){this._onSubmitDelete(id)},setDeleteFileEndpoint:function(endpoint,id){null==id?this._options.deleteFile.endpoint=endpoint:this._deleteFileEndpointStore.setEndpoint(endpoint,id)},_createUploadButton:function(element){var self=this,button=new qq.UploadButton({element:element,multiple:this._options.multiple&&qq.isXhrUploadSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(input){self._onInputChange(input)},hoverClass:this._options.classes.buttonHover,focusClass:this._options.classes.buttonFocus});return this._disposeSupport.addDisposer(function(){button.dispose()}),button},_createUploadHandler:function(){var self=this;return new qq.UploadHandler({debug:this._options.debug,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,uuidParamName:this._options.request.uuidName,totalFileSizeParamName:this._options.request.totalFileSizeName,cors:this._options.cors,demoMode:this._options.demoMode,paramsInBody:this._options.request.paramsInBody,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:function(str,level){self.log(str,level)},onProgress:function(id,name,loaded,total){self._onProgress(id,name,loaded,total),self._options.callbacks.onProgress(id,name,loaded,total)},onComplete:function(id,name,result,xhr){self._onComplete(id,name,result,xhr),self._options.callbacks.onComplete(id,name,result)},onCancel:function(id,name){self._onCancel(id,name),self._options.callbacks.onCancel(id,name)},onUpload:function(id,name){self._onUpload(id,name),self._options.callbacks.onUpload(id,name)},onUploadChunk:function(id,name,chunkData){self._options.callbacks.onUploadChunk(id,name,chunkData)},onResume:function(id,name,chunkData){return self._options.callbacks.onResume(id,name,chunkData)},onAutoRetry:function(id,name,responseJSON,xhr){return self._preventRetries[id]=responseJSON[self._options.retry.preventRetryResponseProperty],self._shouldAutoRetry(id,name,responseJSON)?(self._maybeParseAndSendUploadError(id,name,responseJSON,xhr),self._options.callbacks.onAutoRetry(id,name,self._autoRetries[id]+1),self._onBeforeAutoRetry(id,name),self._retryTimeouts[id]=setTimeout(function(){self._onAutoRetry(id,name,responseJSON)},1e3*self._options.retry.autoAttemptDelay),!0):!1}})},_createDeleteHandler:function(){var self=this;return new qq.DeleteFileAjaxRequestor({maxConnections:this._options.maxConnections,customHeaders:this._options.deleteFile.customHeaders,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,demoMode:this._options.demoMode,cors:this._options.cors,log:function(str,level){self.log(str,level)},onDelete:function(id){self._onDelete(id),self._options.callbacks.onDelete(id)},onDeleteComplete:function(id,xhr,isError){self._onDeleteComplete(id,xhr,isError),self._options.callbacks.onDeleteComplete(id,xhr,isError)}})},_preventLeaveInProgress:function(){var self=this;this._disposeSupport.attach(window,"beforeunload",function(e){if(self._filesInProgress.length){var e=e||window.event;return e.returnValue=self._options.messages.onLeave,self._options.messages.onLeave}})},_onSubmit:function(id){this._options.autoUpload&&this._filesInProgress.push(id)},_onProgress:function(){},_onComplete:function(id,name,result,xhr){this._removeFromFilesInProgress(id),this._maybeParseAndSendUploadError(id,name,result,xhr)},_onCancel:function(id){this._removeFromFilesInProgress(id),clearTimeout(this._retryTimeouts[id]);var storedItemIndex=qq.indexOf(this._storedIds,id);!this._options.autoUpload&&storedItemIndex>=0&&this._storedIds.splice(storedItemIndex,1)},_isDeletePossible:function(){return this._options.deleteFile.enabled&&(!this._options.cors.expected||this._options.cors.expected&&(qq.ie10()||!qq.ie()))},_onSubmitDelete:function(id){return this._isDeletePossible()?void(this._options.callbacks.onSubmitDelete(id)&&this._deleteHandler.sendDelete(id,this.getUuid(id))):(this.log("Delete request ignored for ID "+id+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onDelete:function(){},_onDeleteComplete:function(id,xhr,isError){var name=this._handler.getName(id);isError?(this.log("Delete request for '"+name+"' has failed.","error"),this._options.callbacks.onError(id,name,"Delete request failed with response code "+xhr.status)):this.log("Delete request for '"+name+"' has succeeded.")},_removeFromFilesInProgress:function(id){var index=qq.indexOf(this._filesInProgress,id);index>=0&&this._filesInProgress.splice(index,1)},_onUpload:function(){},_onInputChange:function(input){this.addFiles(qq.isXhrUploadSupported()?input.files:input),this._button.reset()},_onBeforeAutoRetry:function(id,name){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+name+"...")},_onAutoRetry:function(id,name){this.log("Retrying "+name+"..."),this._autoRetries[id]++,this._handler.retry(id)},_shouldAutoRetry:function(id){return!this._preventRetries[id]&&this._options.retry.enableAuto?(void 0===this._autoRetries[id]&&(this._autoRetries[id]=0),this._autoRetries[id]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(id){if(this._preventRetries[id])return this.log("Retries are forbidden for id "+id,"warn"),!1;if(this._handler.isValid(id)){var fileName=this._handler.getName(id);return this._options.callbacks.onManualRetry(id,fileName)===!1?!1:(this.log("Retrying upload for '"+fileName+"' (id: "+id+")..."),this._filesInProgress.push(id),!0)}return this.log("'"+id+"' is not a valid file ID","error"),!1},_maybeParseAndSendUploadError:function(id,name,response,xhr){if(!response.success)if(xhr&&200!==xhr.status&&!response.error)this._options.callbacks.onError(id,name,"XHR returned response code "+xhr.status);else{var errorReason=response.error?response.error:"Upload failure reason unknown";this._options.callbacks.onError(id,name,errorReason)}},_uploadFileOrBlobDataList:function(fileOrBlobDataList){var validationDescriptors,index,batchInvalid;if(validationDescriptors=this._getValidationDescriptors(fileOrBlobDataList),batchInvalid=this._options.callbacks.onValidateBatch(validationDescriptors)===!1,!batchInvalid)if(fileOrBlobDataList.length>0){for(index=0;index<fileOrBlobDataList.length;index++)if(this._validateFileOrBlobData(fileOrBlobDataList[index]))this._upload(fileOrBlobDataList[index]);else if(this._options.validation.stopOnFirstInvalidFile)return}else this._error("noFilesError","")},_upload:function(blobOrFileContainer){var id=this._handler.add(blobOrFileContainer),name=this._handler.getName(id);this._options.callbacks.onSubmit(id,name)!==!1&&(this._onSubmit(id,name),this._options.autoUpload?this._handler.upload(id):this._storeForLater(id))},_storeForLater:function(id){this._storedIds.push(id)},_validateFileOrBlobData:function(fileOrBlobData){var validationDescriptor,name,size;return validationDescriptor=this._getValidationDescriptor(fileOrBlobData),name=validationDescriptor.name,size=validationDescriptor.size,this._options.callbacks.onValidate(validationDescriptor)===!1?!1:qq.isFileOrInput(fileOrBlobData)&&!this._isAllowedExtension(name)?(this._error("typeError",name),!1):0===size?(this._error("emptyError",name),!1):size&&this._options.validation.sizeLimit&&size>this._options.validation.sizeLimit?(this._error("sizeError",name),!1):size&&size<this._options.validation.minSizeLimit?(this._error("minSizeError",name),!1):!0},_error:function(code,name){function r(name,replacement){message=message.replace(name,replacement)}var message=this._options.messages[code],extensions=this._options.validation.allowedExtensions.join(", ").toLowerCase();return r("{file}",this._options.formatFileName(name)),r("{extensions}",extensions),r("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit)),r("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit)),this._options.callbacks.onError(null,name,message),message},_isAllowedExtension:function(fileName){var allowed=this._options.validation.allowedExtensions,valid=!1;return allowed.length?(qq.each(allowed,function(idx,allowedExt){var extRegex=new RegExp("\\."+allowedExt+"$","i");return null!=fileName.match(extRegex)?(valid=!0,!1):void 0}),valid):!0},_formatSize:function(bytes){var i=-1;do bytes/=1024,i++;while(bytes>99);return Math.max(bytes,.1).toFixed(1)+this._options.text.sizeSymbols[i]},_wrapCallbacks:function(){var self,safeCallback;self=this,safeCallback=function(name,callback,args){try{return callback.apply(self,args)}catch(exception){self.log("Caught exception in '"+name+"' callback - "+exception.message,"error")}};for(var prop in this._options.callbacks)!function(){var callbackName,callbackFunc;callbackName=prop,callbackFunc=self._options.callbacks[callbackName],self._options.callbacks[callbackName]=function(){return safeCallback(callbackName,callbackFunc,arguments)}}()},_parseFileOrBlobDataName:function(fileOrBlobData){var name;return name=qq.isFileOrInput(fileOrBlobData)?fileOrBlobData.value?fileOrBlobData.value.replace(/.*(\/|\\)/,""):null!==fileOrBlobData.fileName&&void 0!==fileOrBlobData.fileName?fileOrBlobData.fileName:fileOrBlobData.name:fileOrBlobData.name},_parseFileOrBlobDataSize:function(fileOrBlobData){var size;return qq.isFileOrInput(fileOrBlobData)?fileOrBlobData.value||(size=null!==fileOrBlobData.fileSize&&void 0!==fileOrBlobData.fileSize?fileOrBlobData.fileSize:fileOrBlobData.size):size=fileOrBlobData.blob.size,size},_getValidationDescriptor:function(fileOrBlobData){var name,size,fileDescriptor;return fileDescriptor={},name=this._parseFileOrBlobDataName(fileOrBlobData),size=this._parseFileOrBlobDataSize(fileOrBlobData),fileDescriptor.name=name,size&&(fileDescriptor.size=size),fileDescriptor},_getValidationDescriptors:function(files){var self=this,fileDescriptors=[];return qq.each(files,function(idx,file){fileDescriptors.push(self._getValidationDescriptor(file))}),fileDescriptors},_createParamsStore:function(type){var paramsStore={},self=this;return{setParams:function(params,id){var paramsCopy={};qq.extend(paramsCopy,params),paramsStore[id]=paramsCopy},getParams:function(id){var paramsCopy={};return null!=id&&paramsStore[id]?qq.extend(paramsCopy,paramsStore[id]):qq.extend(paramsCopy,self._options[type].params),paramsCopy},remove:function(fileId){return delete paramsStore[fileId]},reset:function(){paramsStore={}}}},_createEndpointStore:function(type){var endpointStore={},self=this;return{setEndpoint:function(endpoint,id){endpointStore[id]=endpoint},getEndpoint:function(id){return null!=id&&endpointStore[id]?endpointStore[id]:self._options[type].endpoint},remove:function(fileId){return delete endpointStore[fileId]},reset:function(){endpointStore={}}}}},qq.DragAndDrop=function(o){function maybeUploadDroppedFiles(){droppedEntriesCount!==droppedEntriesParsedCount||dirPending||(options.callbacks.log("Grabbed "+droppedFiles.length+" files after tree traversal."),dz.dropDisabled(!1),options.callbacks.dropProcessing(!1,droppedFiles))}function addDroppedFile(file){droppedFiles.push(file),droppedEntriesParsedCount+=1,maybeUploadDroppedFiles()}function traverseFileTree(entry){var dirReader,i;droppedEntriesCount+=1,entry.isFile?entry.file(function(file){addDroppedFile(file)}):entry.isDirectory&&(dirPending=!0,dirReader=entry.createReader(),dirReader.readEntries(function(entries){for(droppedEntriesParsedCount+=1,i=0;i<entries.length;i+=1)traverseFileTree(entries[i]);dirPending=!1,entries.length||maybeUploadDroppedFiles()}))}function handleDataTransfer(dataTransfer){var i,items,entry;if(options.callbacks.dropProcessing(!0),dz.dropDisabled(!0),dataTransfer.files.length>1&&!options.multiple)options.callbacks.dropProcessing(!1),options.callbacks.error("tooManyFilesError",""),dz.dropDisabled(!1);else if(droppedFiles=[],droppedEntriesCount=0,droppedEntriesParsedCount=0,qq.isFolderDropSupported(dataTransfer))for(items=dataTransfer.items,i=0;i<items.length;i+=1)entry=items[i].webkitGetAsEntry(),entry&&(entry.isFile?(droppedFiles.push(items[i].getAsFile()),i===items.length-1&&maybeUploadDroppedFiles()):traverseFileTree(entry));else options.callbacks.dropProcessing(!1,dataTransfer.files),dz.dropDisabled(!1)}function setupDropzone(dropArea){dz=new qq.UploadDropZone({element:dropArea,onEnter:function(e){qq(dropArea).addClass(options.classes.dropActive),e.stopPropagation()},onLeaveNotDescendants:function(){qq(dropArea).removeClass(options.classes.dropActive)},onDrop:function(e){options.hideDropzones&&qq(dropArea).hide(),qq(dropArea).removeClass(options.classes.dropActive),handleDataTransfer(e.dataTransfer)}}),disposeSupport.addDisposer(function(){dz.dispose()}),options.hideDropzones&&qq(dropArea).hide()}function isFileDrag(dragEvent){var fileDrag;return qq.each(dragEvent.dataTransfer.types,function(key,val){return"Files"===val?(fileDrag=!0,!1):void 0}),fileDrag}function setupDragDrop(){options.dropArea&&options.extraDropzones.push(options.dropArea);var i,dropzones=options.extraDropzones;for(i=0;i<dropzones.length;i+=1)setupDropzone(dropzones[i]);!options.dropArea||qq.ie()&&!qq.ie10()||disposeSupport.attach(document,"dragenter",function(e){if(!dz.dropDisabled()&&isFileDrag(e)){if(qq(options.dropArea).hasClass(options.classes.dropDisabled))return;for(options.dropArea.style.display="block",i=0;i<dropzones.length;i+=1)dropzones[i].style.display="block"}}),disposeSupport.attach(document,"dragleave",function(e){if(options.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(e))for(i=0;i<dropzones.length;i+=1)qq(dropzones[i]).hide()}),disposeSupport.attach(document,"drop",function(e){if(options.hideDropzones)for(i=0;i<dropzones.length;i+=1)qq(dropzones[i]).hide();e.preventDefault()})}var options,dz,dirPending,droppedFiles=[],droppedEntriesCount=0,droppedEntriesParsedCount=0,disposeSupport=new qq.DisposeSupport;return options={dropArea:null,extraDropzones:[],hideDropzones:!0,multiple:!0,classes:{dropActive:null},callbacks:{dropProcessing:function(){},error:function(){},log:function(){}}},qq.extend(options,o),{setup:function(){setupDragDrop()},setupExtraDropzone:function(element){options.extraDropzones.push(element),setupDropzone(element)},removeExtraDropzone:function(element){var i,dzs=options.extraDropzones;for(i in dzs)if(dzs[i]===element)return dzs.splice(i,1)},dispose:function(){disposeSupport.dispose(),dz.dispose()}}},qq.UploadDropZone=function(o){function dragover_should_be_canceled(){return qq.safari()||qq.firefox()&&qq.windows()}function disableDropOutside(){dropOutsideDisabled||(dragover_should_be_canceled?disposeSupport.attach(document,"dragover",function(e){e.preventDefault()}):disposeSupport.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),dropOutsideDisabled=!0)}function isValidFileDrag(e){if(qq.ie()&&!qq.ie10())return!1;var effectTest,dt=e.dataTransfer,isSafari=qq.safari();return effectTest=qq.ie10()?!0:"none"!==dt.effectAllowed,dt&&effectTest&&(dt.files||!isSafari&&dt.types.contains&&dt.types.contains("Files"))}function isOrSetDropDisabled(isDisabled){return void 0!==isDisabled&&(preventDrop=isDisabled),preventDrop}function attachEvents(){disposeSupport.attach(element,"dragover",function(e){if(isValidFileDrag(e)){var effect=qq.ie()?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===effect||"linkMove"===effect?"move":"copy",e.stopPropagation(),e.preventDefault()}}),disposeSupport.attach(element,"dragenter",function(e){if(!isOrSetDropDisabled()){if(!isValidFileDrag(e))return;options.onEnter(e)}}),disposeSupport.attach(element,"dragleave",function(e){if(isValidFileDrag(e)){options.onLeave(e);var relatedTarget=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(relatedTarget)||options.onLeaveNotDescendants(e)}}),disposeSupport.attach(element,"drop",function(e){if(!isOrSetDropDisabled()){if(!isValidFileDrag(e))return;e.preventDefault(),options.onDrop(e)}})}var options,element,preventDrop,dropOutsideDisabled,disposeSupport=new qq.DisposeSupport;return options={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}},qq.extend(options,o),element=options.element,disableDropOutside(),attachEvents(),{dropDisabled:function(isDisabled){return isOrSetDropDisabled(isDisabled)},dispose:function(){disposeSupport.dispose()}}},qq.FineUploader=function(o){qq.FineUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",deleteButton:"Delete",failUpload:"Upload failed",dragZone:"Drop files here to upload",dropProcessing:"Processing dropped files...",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(this._options.dragAndDrop&&this._options.dragAndDrop.disableDefaultDropzone?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+(this._options.button?"":'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>')+'<span class="qq-drop-processing"><span>{dropProcessingText}</span><span class="qq-drop-processing-spinner"></span></span>'+(this._options.listElement?"":'<ul class="qq-upload-list"></ul>')+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><a class="qq-upload-delete" href="#">{deleteButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",deleteButton:"qq-upload-delete",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null,dropProcessing:"qq-drop-processing",dropProcessingSpinner:"qq-drop-processing-spinner"},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1},showMessage:function(message){setTimeout(function(){alert(message)},0)},showConfirm:function(message,okCallback,cancelCallback){setTimeout(function(){var result=confirm(message);result?okCallback():cancelCallback&&cancelCallback()},0)}},!0),qq.extend(this._options,o,!0),this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.template=this._options.template.replace(/\{dropProcessingText\}/g,this._options.text.dropProcessing),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{deleteButtonText\}/g,this._options.text.deleteButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._dnd=this._setupDragAndDrop()},qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype),qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments),this._listElement.innerHTML=""},addExtraDropzone:function(element){this._dnd.setupExtraDropzone(element)},removeExtraDropzone:function(element){return this._dnd.removeExtraDropzone(element)},getItemByFileId:function(id){for(var item=this._listElement.firstChild;item;){if(item.qqFileId==id)return item;item=item.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments),this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._dnd.dispose(),this._dnd=this._setupDragAndDrop()},_removeFileItem:function(fileId){var item=this.getItemByFileId(fileId);qq(item).remove()},_setupDragAndDrop:function(){var dnd,preventSelectFiles,defaultDropAreaEl,self=this,dropProcessingEl=this._find(this._element,"dropProcessing");return preventSelectFiles=function(event){event.preventDefault()},this._options.dragAndDrop.disableDefaultDropzone||(defaultDropAreaEl=this._find(this._options.element,"drop")),dnd=new qq.DragAndDrop({dropArea:defaultDropAreaEl,extraDropzones:this._options.dragAndDrop.extraDropzones,hideDropzones:this._options.dragAndDrop.hideDropzones,multiple:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{dropProcessing:function(isProcessing,files){var input=self._button.getInput();isProcessing?(qq(dropProcessingEl).css({display:"block"}),qq(input).attach("click",preventSelectFiles)):(qq(dropProcessingEl).hide(),qq(input).detach("click",preventSelectFiles)),files&&self.addFiles(files)},error:function(code,filename){self._error(code,filename)},log:function(message,level){self.log(message,level)}}}),dnd.setup(),dnd},_leaving_document_out:function(e){return(qq.chrome()||qq.safari()&&qq.windows())&&0==e.clientX&&0==e.clientY||qq.firefox()&&!e.relatedTarget},_storeForLater:function(id){qq.FineUploaderBasic.prototype._storeForLater.apply(this,arguments);var item=this.getItemByFileId(id);qq(this._find(item,"spinner")).hide()},_find:function(parent,type){var element=qq(parent).getByClass(this._options.classes[type])[0];if(!element)throw new Error("element not found "+type);return element},_onSubmit:function(id,name){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(id,name)},_onProgress:function(id,name,loaded,total){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var item,progressBar,percent,cancelLink;item=this.getItemByFileId(id),progressBar=this._find(item,"progressBar"),percent=Math.round(loaded/total*100),loaded===total?(cancelLink=this._find(item,"cancel"),qq(cancelLink).hide(),qq(progressBar).hide(),qq(this._find(item,"statusText")).setText(this._options.text.waitingForResponse),this._displayFileSize(id)):(this._displayFileSize(id,loaded,total),qq(progressBar).css({display:"block"})),qq(progressBar).css({width:percent+"%"})},_onComplete:function(id,name,result){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var item=this.getItemByFileId(id);qq(this._find(item,"statusText")).clearText(),qq(item).removeClass(this._classes.retrying),qq(this._find(item,"progressBar")).hide(),(!this._options.disableCancelForFormUploads||qq.isXhrUploadSupported())&&qq(this._find(item,"cancel")).hide(),qq(this._find(item,"spinner")).hide(),result.success?(this._isDeletePossible()&&this._showDeleteLink(id),qq(item).addClass(this._classes.success),this._classes.successIcon&&(this._find(item,"finished").style.display="inline-block",qq(item).addClass(this._classes.successIcon))):(qq(item).addClass(this._classes.fail),this._classes.failIcon&&(this._find(item,"finished").style.display="inline-block",qq(item).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[id]&&qq(item).addClass(this._classes.retryable),this._controlFailureTextDisplay(item,result))},_onUpload:function(id){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments),this._showSpinner(id)},_onCancel:function(id){qq.FineUploaderBasic.prototype._onCancel.apply(this,arguments),this._removeFileItem(id)},_onBeforeAutoRetry:function(id){var item,progressBar,failTextEl,retryNumForDisplay,maxAuto,retryNote;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments),item=this.getItemByFileId(id),progressBar=this._find(item,"progressBar"),this._showCancelLink(item),progressBar.style.width=0,qq(progressBar).hide(),this._options.retry.showAutoRetryNote&&(failTextEl=this._find(item,"statusText"),retryNumForDisplay=this._autoRetries[id]+1,maxAuto=this._options.retry.maxAutoAttempts,retryNote=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,retryNumForDisplay),retryNote=retryNote.replace(/\{maxAuto\}/g,maxAuto),qq(failTextEl).setText(retryNote),1===retryNumForDisplay&&qq(item).addClass(this._classes.retrying))},_onBeforeManualRetry:function(id){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var item=this.getItemByFileId(id);return this._find(item,"progressBar").style.width=0,qq(item).removeClass(this._classes.fail),qq(this._find(item,"statusText")).clearText(),this._showSpinner(id),this._showCancelLink(item),!0}return!1},_onSubmitDelete:function(id){return this._isDeletePossible()?void(this._options.callbacks.onSubmitDelete(id)!==!1&&(this._options.deleteFile.forceConfirm?this._showDeleteConfirm(id):this._sendDeleteRequest(id))):(this.log("Delete request ignored for file ID "+id+", delete feature is disabled.","warn"),!1)},_onDeleteComplete:function(id,xhr,isError){qq.FineUploaderBasic.prototype._onDeleteComplete.apply(this,arguments);var item=this.getItemByFileId(id),spinnerEl=this._find(item,"spinner"),statusTextEl=this._find(item,"statusText");qq(spinnerEl).hide(),isError?(qq(statusTextEl).setText(this._options.deleteFile.deletingFailedText),this._showDeleteLink(id)):this._removeFileItem(id)},_sendDeleteRequest:function(id){var item=this.getItemByFileId(id),deleteLink=this._find(item,"deleteButton"),statusTextEl=this._find(item,"statusText");qq(deleteLink).hide(),this._showSpinner(id),qq(statusTextEl).setText(this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete(id,this.getUuid(id))},_showDeleteConfirm:function(id){var fileName=this._handler.getName(id),confirmMessage=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,fileName),self=(this.getUuid(id),this);this._options.showConfirm(confirmMessage,function(){self._sendDeleteRequest(id)})},_addToList:function(id,name){var item=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.isXhrUploadSupported()){var cancelLink=this._find(item,"cancel");qq(cancelLink).remove()}item.qqFileId=id;var fileElement=this._find(item,"file");qq(fileElement).setText(this._options.formatFileName(name)),qq(this._find(item,"size")).hide(),this._options.multiple||(this._handler.cancelAll(),this._clearList()),this._listElement.appendChild(item),this._options.display.fileSizeOnSubmit&&qq.isXhrUploadSupported()&&this._displayFileSize(id)},_clearList:function(){this._listElement.innerHTML="",this.clearStoredFiles()},_displayFileSize:function(id,loadedSize,totalSize){var item=this.getItemByFileId(id),size=this.getSize(id),sizeForDisplay=this._formatSize(size),sizeEl=this._find(item,"size");void 0!==loadedSize&&void 0!==totalSize&&(sizeForDisplay=this._formatProgress(loadedSize,totalSize)),qq(sizeEl).css({display:"inline"}),qq(sizeEl).setText(sizeForDisplay)},_bindCancelAndRetryEvents:function(){var self=this,list=this._listElement;this._disposeSupport.attach(list,"click",function(e){e=e||window.event;var target=e.target||e.srcElement;if(qq(target).hasClass(self._classes.cancel)||qq(target).hasClass(self._classes.retry)||qq(target).hasClass(self._classes.deleteButton)){qq.preventDefault(e);for(var item=target.parentNode;void 0===item.qqFileId;)item=target=target.parentNode;qq(target).hasClass(self._classes.deleteButton)?self.deleteFile(item.qqFileId):qq(target).hasClass(self._classes.cancel)?self.cancel(item.qqFileId):(qq(item).removeClass(self._classes.retryable),self.retry(item.qqFileId))}})},_formatProgress:function(uploadedSize,totalSize){function r(name,replacement){message=message.replace(name,replacement)}var message=this._options.text.formatProgress;return r("{percent}",Math.round(uploadedSize/totalSize*100)),r("{total_size}",this._formatSize(totalSize)),message},_controlFailureTextDisplay:function(item,response){var mode,maxChars,responseProperty,failureReason,shortFailureReason;mode=this._options.failedUploadTextDisplay.mode,maxChars=this._options.failedUploadTextDisplay.maxChars,responseProperty=this._options.failedUploadTextDisplay.responseProperty,"custom"===mode?(failureReason=response[responseProperty],failureReason?failureReason.length>maxChars&&(shortFailureReason=failureReason.substring(0,maxChars)+"..."):(failureReason=this._options.text.failUpload,this.log("'"+responseProperty+"' is not a valid property on the server response.","warn")),qq(this._find(item,"statusText")).setText(shortFailureReason||failureReason),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(item,failureReason)):"default"===mode?qq(this._find(item,"statusText")).setText(this._options.text.failUpload):"none"!==mode&&this.log("failedUploadTextDisplay.mode value of '"+mode+"' is not valid","warn")},_showTooltip:function(item,text){item.title=text},_showSpinner:function(id){var item=this.getItemByFileId(id),spinnerEl=this._find(item,"spinner");spinnerEl.style.display="inline-block"},_showCancelLink:function(item){if(!this._options.disableCancelForFormUploads||qq.isXhrUploadSupported()){var cancelLink=this._find(item,"cancel");qq(cancelLink).css({display:"inline"})}},_showDeleteLink:function(id){var item=this.getItemByFileId(id),deleteLink=this._find(item,"deleteButton");qq(deleteLink).css({display:"inline"})},_error:function(){var message=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(message)}}),qq.AjaxRequestor=function(o){function dequeue(id){var nextId,i=qq.indexOf(queue,id),max=options.maxConnections;delete requestState[id],queue.splice(i,1),queue.length>=max&&max>i&&(nextId=queue[max-1],sendRequest(nextId))}function onComplete(id){var xhr=requestState[id].xhr,method=getMethod(),isError=!1;dequeue(id),isResponseSuccessful(xhr.status)||(isError=!0,log(method+" request for "+id+" has failed - response code "+xhr.status,"error")),options.onComplete(id,xhr,isError)}function sendRequest(id){var url,xhr=new XMLHttpRequest,method=getMethod(),params={};options.onSend(id),options.paramsStore.getParams&&(params=options.paramsStore.getParams(id)),url=createUrl(id,params),requestState[id].xhr=xhr,xhr.onreadystatechange=getReadyStateChangeHandler(id),xhr.open(method,url,!0),options.cors.expected&&options.cors.sendCredentials&&(xhr.withCredentials=!0),setHeaders(id),log("Sending "+method+" request for "+id),!shouldParamsBeInQueryString&&params?xhr.send(qq.obj2url(params,"")):xhr.send()
}function createUrl(id,params){var endpoint=options.endpointStore.getEndpoint(id),addToPath=requestState[id].addToPath;return void 0!==addToPath&&(endpoint+="/"+addToPath),shouldParamsBeInQueryString&&params?qq.obj2url(params,endpoint):endpoint}function getReadyStateChangeHandler(id){var xhr=requestState[id].xhr;return function(){4===xhr.readyState&&onComplete(id,xhr)}}function setHeaders(id){var xhr=requestState[id].xhr,customHeaders=options.customHeaders;xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("Cache-Control","no-cache"),qq.each(customHeaders,function(name,val){xhr.setRequestHeader(name,val)})}function cancelRequest(id){var xhr=requestState[id].xhr,method=getMethod();return xhr?(xhr.onreadystatechange=null,xhr.abort(),dequeue(id),log("Cancelled "+method+" for "+id),options.onCancel(id),!0):!1}function isResponseSuccessful(responseCode){return qq.indexOf(options.successfulResponseCodes,responseCode)>=0}function getMethod(){return options.demoMode?"GET":options.method}var log,shouldParamsBeInQueryString,queue=[],requestState=[],options={method:"POST",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},successfulResponseCodes:[200],demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onSend:function(){},onComplete:function(){},onCancel:function(){}};return qq.extend(options,o),log=options.log,shouldParamsBeInQueryString="GET"===getMethod()||"DELETE"===getMethod(),{send:function(id,addToPath){requestState[id]={addToPath:addToPath};var len=queue.push(id);len<=options.maxConnections&&sendRequest(id)},cancel:function(id){return cancelRequest(id)}}},qq.DeleteFileAjaxRequestor=function(o){var requestor,options={endpointStore:{},maxConnections:3,customHeaders:{},paramsStore:{},demoMode:!1,cors:{expected:!1,sendCredentials:!1},log:function(){},onDelete:function(){},onDeleteComplete:function(){}};return qq.extend(options,o),requestor=new qq.AjaxRequestor({method:"DELETE",endpointStore:options.endpointStore,paramsStore:options.paramsStore,maxConnections:options.maxConnections,customHeaders:options.customHeaders,successfulResponseCodes:[200,202,204],demoMode:options.demoMode,log:options.log,onSend:options.onDelete,onComplete:options.onDeleteComplete}),{sendDelete:function(id,uuid){requestor.send(id,uuid),options.log("Submitted delete file request for "+id)}}},qq.WindowReceiveMessage=function(o){var options={log:function(){}},callbackWrapperDetachers={};return qq.extend(options,o),{receiveMessage:function(id,callback){var onMessageCallbackWrapper=function(event){callback(event.data)};window.postMessage?callbackWrapperDetachers[id]=qq(window).attach("message",onMessageCallbackWrapper):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(id){if(window.postMessage){var detacher=callbackWrapperDetachers[id];detacher&&detacher()}}}},qq.UploadHandler=function(o){var options,log,dequeue,handlerImpl,queue=[];return options={debug:!1,forceMultipart:!0,paramsInBody:!1,paramsStore:{},endpointStore:{},cors:{expected:!1,sendCredentials:!1},maxConnections:3,uuidParamName:"qquuid",totalFileSizeParamName:"qqtotalfilesize",chunking:{enabled:!1,partSize:2e6,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalParts:"qqtotalparts",filename:"qqfilename"}},resume:{enabled:!1,id:null,cookiesExpireIn:7,paramNames:{resuming:"qqresume"}},blobs:{paramNames:{name:"qqblobname"}},log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onUploadChunk:function(){},onAutoRetry:function(){},onResume:function(){}},qq.extend(options,o),log=options.log,dequeue=function(id){var nextId,i=qq.indexOf(queue,id),max=options.maxConnections;i>=0&&(queue.splice(i,1),queue.length>=max&&max>i&&(nextId=queue[max-1],handlerImpl.upload(nextId)))},handlerImpl=qq.isXhrUploadSupported()?new qq.UploadHandlerXhr(options,dequeue,log):new qq.UploadHandlerForm(options,dequeue,log),{add:function(file){return handlerImpl.add(file)},upload:function(id){var len=queue.push(id);return len<=options.maxConnections?handlerImpl.upload(id):void 0},retry:function(id){var i=qq.indexOf(queue,id);return i>=0?handlerImpl.upload(id,!0):this.upload(id)},cancel:function(id){log("Cancelling "+id),options.paramsStore.remove(id),handlerImpl.cancel(id),dequeue(id)},cancelAll:function(){var self=this,queueCopy=[];qq.extend(queueCopy,queue),qq.each(queueCopy,function(idx,fileId){self.cancel(fileId)}),queue=[]},getName:function(id){return handlerImpl.getName(id)},getSize:function(id){return handlerImpl.getSize?handlerImpl.getSize(id):void 0},getFile:function(id){return handlerImpl.getFile?handlerImpl.getFile(id):void 0},getQueue:function(){return queue},reset:function(){log("Resetting upload handler"),queue=[],handlerImpl.reset()},getUuid:function(id){return handlerImpl.getUuid(id)},isValid:function(id){return handlerImpl.isValid(id)},getResumableFilesData:function(){return handlerImpl.getResumableFilesData?handlerImpl.getResumableFilesData():[]}}},qq.UploadHandlerForm=function(o,uploadCompleteCallback,logCallback){function detachLoadEvent(id){void 0!==detachLoadEvents[id]&&(detachLoadEvents[id](),delete detachLoadEvents[id])}function registerPostMessageCallback(iframe,callback){var id=iframe.id;onloadCallbacks[uuids[id]]=callback,detachLoadEvents[id]=qq(iframe).attach("load",function(){inputs[id]&&(log("Received iframe load event for CORS upload request (file id "+id+")"),postMessageCallbackTimers[id]=setTimeout(function(){var errorMessage="No valid message received from loaded iframe for file id "+id;log(errorMessage,"error"),callback({error:errorMessage})},1e3))}),corsMessageReceiver.receiveMessage(id,function(message){log("Received the following window message: '"+message+"'");var onloadCallback,response=qq.parseJson(message),uuid=response.uuid;uuid&&onloadCallbacks[uuid]?(clearTimeout(postMessageCallbackTimers[id]),delete postMessageCallbackTimers[id],detachLoadEvent(id),onloadCallback=onloadCallbacks[uuid],delete onloadCallbacks[uuid],corsMessageReceiver.stopReceivingMessages(id),onloadCallback(response)):uuid||log("'"+message+"' does not contain a UUID - ignoring.")})}function attachLoadEvent(iframe,callback){options.cors.expected?registerPostMessageCallback(iframe,callback):detachLoadEvents[iframe.id]=qq(iframe).attach("load",function(){if(log("Received response for "+iframe.id),iframe.parentNode){try{if(iframe.contentDocument&&iframe.contentDocument.body&&"false"==iframe.contentDocument.body.innerHTML)return}catch(error){log("Error when attempting to access iframe during handling of upload response ("+error+")","error")}callback()}})}function getIframeContentJson(iframe){var response;try{var doc=iframe.contentDocument||iframe.contentWindow.document,innerHTML=doc.body.innerHTML;log("converting iframe's innerHTML to JSON"),log("innerHTML = "+innerHTML),innerHTML&&innerHTML.match(/^<pre/i)&&(innerHTML=doc.body.firstChild.firstChild.nodeValue),response=qq.parseJson(innerHTML)}catch(error){log("Error when attempting to parse form upload response ("+error+")","error"),response={success:!1}}return response}function createIframe(id){var iframe=qq.toElement('<iframe src="javascript:false;" name="'+id+'" />');return iframe.setAttribute("id",id),iframe.style.display="none",document.body.appendChild(iframe),iframe}function createForm(id,iframe){var params=options.paramsStore.getParams(id),protocol=options.demoMode?"GET":"POST",form=qq.toElement('<form method="'+protocol+'" enctype="multipart/form-data"></form>'),endpoint=options.endpointStore.getEndpoint(id),url=endpoint;return params[options.uuidParamName]=uuids[id],options.paramsInBody?qq.obj2Inputs(params,form):url=qq.obj2url(params,endpoint),form.setAttribute("action",url),form.setAttribute("target",iframe.name),form.style.display="none",document.body.appendChild(form),form}var api,options=o,inputs=[],uuids=[],detachLoadEvents={},postMessageCallbackTimers={},uploadComplete=uploadCompleteCallback,log=logCallback,corsMessageReceiver=new qq.WindowReceiveMessage({log:log}),onloadCallbacks={};return api={add:function(fileInput){fileInput.setAttribute("name",options.inputName);var id=inputs.push(fileInput)-1;return uuids[id]=qq.getUniqueId(),fileInput.parentNode&&qq(fileInput).remove(),id},getName:function(id){return inputs[id].value.replace(/.*(\/|\\)/,"")},isValid:function(id){return void 0!==inputs[id]},reset:function(){qq.UploadHandler.prototype.reset.apply(this,arguments),inputs=[],uuids=[],detachLoadEvents={}},getUuid:function(id){return uuids[id]},cancel:function(id){options.onCancel(id,this.getName(id)),delete inputs[id],delete uuids[id],delete detachLoadEvents[id],options.cors.expected&&(clearTimeout(postMessageCallbackTimers[id]),delete postMessageCallbackTimers[id],corsMessageReceiver.stopReceivingMessages(id));var iframe=document.getElementById(id);iframe&&(iframe.setAttribute("src","java"+String.fromCharCode(115)+"cript:false;"),qq(iframe).remove())},upload:function(id){var form,input=inputs[id],fileName=api.getName(id),iframe=createIframe(id);if(!input)throw new Error("file with passed id was not added, or already uploaded or cancelled");return options.onUpload(id,this.getName(id)),form=createForm(id,iframe),form.appendChild(input),attachLoadEvent(iframe,function(responseFromMessage){log("iframe loaded");var response=responseFromMessage?responseFromMessage:getIframeContentJson(iframe);detachLoadEvent(id),options.cors.expected||qq(iframe).remove(),(response.success||!options.onAutoRetry(id,fileName,response))&&(options.onComplete(id,fileName,response),uploadComplete(id))}),log("Sending upload request for "+id),form.submit(),qq(form).remove(),id}}},qq.UploadHandlerXhr=function(o,uploadCompleteCallback,logCallback){function addChunkingSpecificParams(id,params,chunkData){var size=api.getSize(id),name=api.getName(id);params[options.chunking.paramNames.partIndex]=chunkData.part,params[options.chunking.paramNames.partByteOffset]=chunkData.start,params[options.chunking.paramNames.chunkSize]=chunkData.size,params[options.chunking.paramNames.totalParts]=chunkData.count,params[options.totalFileSizeParamName]=size,multipart&&(params[options.chunking.paramNames.filename]=name)}function addResumeSpecificParams(params){params[options.resume.paramNames.resuming]=!0}function getChunk(fileOrBlob,startByte,endByte){return fileOrBlob.slice?fileOrBlob.slice(startByte,endByte):fileOrBlob.mozSlice?fileOrBlob.mozSlice(startByte,endByte):fileOrBlob.webkitSlice?fileOrBlob.webkitSlice(startByte,endByte):void 0}function getChunkData(id,chunkIndex){var chunkSize=options.chunking.partSize,fileSize=api.getSize(id),fileOrBlob=fileState[id].file||fileState[id].blobData.blob,startBytes=chunkSize*chunkIndex,endBytes=startBytes+chunkSize>=fileSize?fileSize:startBytes+chunkSize,totalChunks=getTotalChunks(id);return{part:chunkIndex,start:startBytes,end:endBytes,count:totalChunks,blob:getChunk(fileOrBlob,startBytes,endBytes),size:endBytes-startBytes}}function getTotalChunks(id){var fileSize=api.getSize(id),chunkSize=options.chunking.partSize;return Math.ceil(fileSize/chunkSize)}function createXhr(id){var xhr=new XMLHttpRequest;return fileState[id].xhr=xhr,xhr}function setParamsAndGetEntityToSend(params,xhr,fileOrBlob,id){var formData=new FormData,method=options.demoMode?"GET":"POST",endpoint=options.endpointStore.getEndpoint(id),url=endpoint,name=api.getName(id),size=api.getSize(id),blobData=fileState[id].blobData;return params[options.uuidParamName]=fileState[id].uuid,multipart&&(params[options.totalFileSizeParamName]=size,blobData&&(params[options.blobs.paramNames.name]=blobData.name)),options.paramsInBody||(multipart||(params[options.inputName]=name),url=qq.obj2url(params,endpoint)),xhr.open(method,url,!0),options.cors.expected&&options.cors.sendCredentials&&(xhr.withCredentials=!0),multipart?(options.paramsInBody&&qq.obj2FormData(params,formData),formData.append(options.inputName,fileOrBlob),formData):fileOrBlob}function setHeaders(id,xhr){var extraHeaders=options.customHeaders,fileOrBlob=fileState[id].file||fileState[id].blobData.blob;xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("Cache-Control","no-cache"),multipart||(xhr.setRequestHeader("Content-Type","application/octet-stream"),xhr.setRequestHeader("X-Mime-Type",fileOrBlob.type)),qq.each(extraHeaders,function(name,val){xhr.setRequestHeader(name,val)})}function handleCompletedItem(id,response,xhr){var name=api.getName(id),size=api.getSize(id);fileState[id].attemptingResume=!1,options.onProgress(id,name,size,size),options.onComplete(id,name,response,xhr),delete fileState[id].xhr,uploadComplete(id)}function uploadNextChunk(id){var toSend,params,chunkIdx=fileState[id].remainingChunkIdxs[0],chunkData=getChunkData(id,chunkIdx),xhr=createXhr(id),size=api.getSize(id),name=api.getName(id);void 0===fileState[id].loaded&&(fileState[id].loaded=0),resumeEnabled&&fileState[id].file&&persistChunkData(id,chunkData),xhr.onreadystatechange=getReadyStateChangeHandler(id,xhr),xhr.upload.onprogress=function(e){if(e.lengthComputable){var totalLoaded=e.loaded+fileState[id].loaded,estTotalRequestsSize=calcAllRequestsSizeForChunkedUpload(id,chunkIdx,e.total);options.onProgress(id,name,totalLoaded,estTotalRequestsSize)}},options.onUploadChunk(id,name,getChunkDataForCallback(chunkData)),params=options.paramsStore.getParams(id),addChunkingSpecificParams(id,params,chunkData),fileState[id].attemptingResume&&addResumeSpecificParams(params),toSend=setParamsAndGetEntityToSend(params,xhr,chunkData.blob,id),setHeaders(id,xhr),log("Sending chunked upload request for item "+id+": bytes "+(chunkData.start+1)+"-"+chunkData.end+" of "+size),xhr.send(toSend)}function calcAllRequestsSizeForChunkedUpload(id,chunkIdx,requestSize){var chunkData=getChunkData(id,chunkIdx),blobSize=chunkData.size,overhead=requestSize-blobSize,size=api.getSize(id),chunkCount=chunkData.count,initialRequestOverhead=fileState[id].initialRequestOverhead,overheadDiff=overhead-initialRequestOverhead;return fileState[id].lastRequestOverhead=overhead,0===chunkIdx?(fileState[id].lastChunkIdxProgress=0,fileState[id].initialRequestOverhead=overhead,fileState[id].estTotalRequestsSize=size+chunkCount*overhead):fileState[id].lastChunkIdxProgress!==chunkIdx&&(fileState[id].lastChunkIdxProgress=chunkIdx,fileState[id].estTotalRequestsSize+=overheadDiff),fileState[id].estTotalRequestsSize}function getLastRequestOverhead(id){return multipart?fileState[id].lastRequestOverhead:0}function handleSuccessfullyCompletedChunk(id,response,xhr){var chunkIdx=fileState[id].remainingChunkIdxs.shift(),chunkData=getChunkData(id,chunkIdx);fileState[id].attemptingResume=!1,fileState[id].loaded+=chunkData.size+getLastRequestOverhead(id),fileState[id].remainingChunkIdxs.length>0?uploadNextChunk(id):(resumeEnabled&&deletePersistedChunkData(id),handleCompletedItem(id,response,xhr))}function isErrorResponse(xhr,response){return 200!==xhr.status||!response.success||response.reset}function parseResponse(xhr){var response;try{response=qq.parseJson(xhr.responseText)}catch(error){log("Error when attempting to parse xhr response text ("+error+")","error"),response={}}return response}function handleResetResponse(id){log("Server has ordered chunking effort to be restarted on next attempt for item ID "+id,"error"),resumeEnabled&&(deletePersistedChunkData(id),fileState[id].attemptingResume=!1),fileState[id].remainingChunkIdxs=[],delete fileState[id].loaded,delete fileState[id].estTotalRequestsSize,delete fileState[id].initialRequestOverhead}function handleResetResponseOnResumeAttempt(id){fileState[id].attemptingResume=!1,log("Server has declared that it cannot handle resume for item ID "+id+" - starting from the first chunk","error"),handleResetResponse(id),api.upload(id,!0)}function handleNonResetErrorResponse(id,response,xhr){var name=api.getName(id);options.onAutoRetry(id,name,response,xhr)||handleCompletedItem(id,response,xhr)}function onComplete(id,xhr){var response;fileState[id]&&(log("xhr - server response received for "+id),log("responseText = "+xhr.responseText),response=parseResponse(xhr),isErrorResponse(xhr,response)?(response.reset&&handleResetResponse(id),fileState[id].attemptingResume&&response.reset?handleResetResponseOnResumeAttempt(id):handleNonResetErrorResponse(id,response,xhr)):chunkFiles?handleSuccessfullyCompletedChunk(id,response,xhr):handleCompletedItem(id,response,xhr))}function getChunkDataForCallback(chunkData){return{partIndex:chunkData.part,startByte:chunkData.start+1,endByte:chunkData.end,totalParts:chunkData.count}}function getReadyStateChangeHandler(id,xhr){return function(){4===xhr.readyState&&onComplete(id,xhr)}}function persistChunkData(id,chunkData){var fileUuid=api.getUuid(id),lastByteSent=fileState[id].loaded,initialRequestOverhead=fileState[id].initialRequestOverhead,estTotalRequestsSize=fileState[id].estTotalRequestsSize,cookieName=getChunkDataCookieName(id),cookieValue=fileUuid+cookieItemDelimiter+chunkData.part+cookieItemDelimiter+lastByteSent+cookieItemDelimiter+initialRequestOverhead+cookieItemDelimiter+estTotalRequestsSize,cookieExpDays=options.resume.cookiesExpireIn;qq.setCookie(cookieName,cookieValue,cookieExpDays)}function deletePersistedChunkData(id){if(fileState[id].file){var cookieName=getChunkDataCookieName(id);qq.deleteCookie(cookieName)}}function getPersistedChunkData(id){var sections,uuid,partIndex,lastByteSent,initialRequestOverhead,estTotalRequestsSize,chunkCookieValue=qq.getCookie(getChunkDataCookieName(id)),filename=api.getName(id);if(chunkCookieValue){if(sections=chunkCookieValue.split(cookieItemDelimiter),5===sections.length)return uuid=sections[0],partIndex=parseInt(sections[1],10),lastByteSent=parseInt(sections[2],10),initialRequestOverhead=parseInt(sections[3],10),estTotalRequestsSize=parseInt(sections[4],10),{uuid:uuid,part:partIndex,lastByteSent:lastByteSent,initialRequestOverhead:initialRequestOverhead,estTotalRequestsSize:estTotalRequestsSize};log("Ignoring previously stored resume/chunk cookie for "+filename+" - old cookie format","warn")}}function getChunkDataCookieName(id){var cookieName,filename=api.getName(id),fileSize=api.getSize(id),maxChunkSize=options.chunking.partSize;return cookieName="qqfilechunk"+cookieItemDelimiter+encodeURIComponent(filename)+cookieItemDelimiter+fileSize+cookieItemDelimiter+maxChunkSize,void 0!==resumeId&&(cookieName+=cookieItemDelimiter+resumeId),cookieName}function getResumeId(){return null===options.resume.id||void 0===options.resume.id||qq.isFunction(options.resume.id)||qq.isObject(options.resume.id)?void 0:options.resume.id}function handleFileChunkingUpload(id,retry){var persistedChunkInfoForResume,firstChunkDataForResume,currentChunkIndex,name=api.getName(id),firstChunkIndex=0;if(!fileState[id].remainingChunkIdxs||0===fileState[id].remainingChunkIdxs.length)for(fileState[id].remainingChunkIdxs=[],resumeEnabled&&!retry&&fileState[id].file&&(persistedChunkInfoForResume=getPersistedChunkData(id),persistedChunkInfoForResume&&(firstChunkDataForResume=getChunkData(id,persistedChunkInfoForResume.part),options.onResume(id,name,getChunkDataForCallback(firstChunkDataForResume))!==!1&&(firstChunkIndex=persistedChunkInfoForResume.part,fileState[id].uuid=persistedChunkInfoForResume.uuid,fileState[id].loaded=persistedChunkInfoForResume.lastByteSent,fileState[id].estTotalRequestsSize=persistedChunkInfoForResume.estTotalRequestsSize,fileState[id].initialRequestOverhead=persistedChunkInfoForResume.initialRequestOverhead,fileState[id].attemptingResume=!0,log("Resuming "+name+" at partition index "+firstChunkIndex)))),currentChunkIndex=getTotalChunks(id)-1;currentChunkIndex>=firstChunkIndex;currentChunkIndex-=1)fileState[id].remainingChunkIdxs.unshift(currentChunkIndex);uploadNextChunk(id)}function handleStandardFileUpload(id){var xhr,params,toSend,fileOrBlob=fileState[id].file||fileState[id].blobData.blob,name=api.getName(id);fileState[id].loaded=0,xhr=createXhr(id),xhr.upload.onprogress=function(e){e.lengthComputable&&(fileState[id].loaded=e.loaded,options.onProgress(id,name,e.loaded,e.total))},xhr.onreadystatechange=getReadyStateChangeHandler(id,xhr),params=options.paramsStore.getParams(id),toSend=setParamsAndGetEntityToSend(params,xhr,fileOrBlob,id),setHeaders(id,xhr),log("Sending upload request for "+id),xhr.send(toSend)}var api,options=o,uploadComplete=uploadCompleteCallback,log=logCallback,fileState=[],cookieItemDelimiter="|",chunkFiles=options.chunking.enabled&&qq.isFileChunkingSupported(),resumeEnabled=options.resume.enabled&&chunkFiles&&qq.areCookiesEnabled(),resumeId=getResumeId(),multipart=options.forceMultipart||options.paramsInBody;return api={add:function(fileOrBlobData){var id;if(fileOrBlobData instanceof File)id=fileState.push({file:fileOrBlobData})-1;else{if(!(fileOrBlobData.blob instanceof Blob))throw new Error("Passed obj in not a File or BlobData (in qq.UploadHandlerXhr)");id=fileState.push({blobData:fileOrBlobData})-1}return fileState[id].uuid=qq.getUniqueId(),id},getName:function(id){var file=fileState[id].file,blobData=fileState[id].blobData;return file?null!==file.fileName&&void 0!==file.fileName?file.fileName:file.name:blobData.name},getSize:function(id){var fileOrBlob=fileState[id].file||fileState[id].blobData.blob;return qq.isFileOrInput(fileOrBlob)&&null!=fileOrBlob.fileSize?fileOrBlob.fileSize:fileOrBlob.size},getFile:function(id){return fileState[id]?fileState[id].file||fileState[id].blobData.blob:void 0},getLoaded:function(id){return fileState[id].loaded||0},isValid:function(id){return void 0!==fileState[id]},reset:function(){fileState=[]},getUuid:function(id){return fileState[id].uuid},upload:function(id,retry){var name=this.getName(id);options.onUpload(id,name),chunkFiles?handleFileChunkingUpload(id,retry):handleStandardFileUpload(id)},cancel:function(id){var xhr=fileState[id].xhr;options.onCancel(id,this.getName(id)),xhr&&(xhr.onreadystatechange=null,xhr.abort()),resumeEnabled&&deletePersistedChunkData(id),delete fileState[id]},getResumableFilesData:function(){var matchingCookieNames=[],resumableFilesData=[];return chunkFiles&&resumeEnabled?(matchingCookieNames=qq.getCookieNames(void 0===resumeId?new RegExp("^qqfilechunk\\"+cookieItemDelimiter+".+\\"+cookieItemDelimiter+"\\d+\\"+cookieItemDelimiter+options.chunking.partSize+"="):new RegExp("^qqfilechunk\\"+cookieItemDelimiter+".+\\"+cookieItemDelimiter+"\\d+\\"+cookieItemDelimiter+options.chunking.partSize+"\\"+cookieItemDelimiter+resumeId+"=")),qq.each(matchingCookieNames,function(idx,cookieName){var cookiesNameParts=cookieName.split(cookieItemDelimiter),cookieValueParts=qq.getCookie(cookieName).split(cookieItemDelimiter);resumableFilesData.push({name:decodeURIComponent(cookiesNameParts[1]),size:cookiesNameParts[2],uuid:cookieValueParts[0],partIdx:cookieValueParts[1]})}),resumableFilesData):[]}}},define("libs/fineuploader",function(){}),function(window,angular){function $SanitizeProvider(){this.$get=["$$sanitizeUri",function($$sanitizeUri){return function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}]}function sanitizeText(chars){var buf=[],writer=htmlSanitizeWriter(buf,angular.noop);return writer.chars(chars),buf.join("")}function makeMap(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}function htmlParser(html,handler){function parseStartTag(tag,tagName,rest,unary){if(tagName=angular.lowercase(tagName),blockElements[tagName])for(;stack.last()&&inlineElements[stack.last()];)parseEndTag("",stack.last());optionalEndTagElements[tagName]&&stack.last()==tagName&&parseEndTag("",tagName),unary=voidElements[tagName]||!!unary,unary||stack.push(tagName);var attrs={};rest.replace(ATTR_REGEXP,function(match,name,doubleQuotedValue,singleQuotedValue,unquotedValue){var value=doubleQuotedValue||singleQuotedValue||unquotedValue||"";attrs[name]=decodeEntities(value)}),handler.start&&handler.start(tagName,attrs,unary)}function parseEndTag(tag,tagName){var i,pos=0;if(tagName=angular.lowercase(tagName))for(pos=stack.length-1;pos>=0&&stack[pos]!=tagName;pos--);if(pos>=0){for(i=stack.length-1;i>=pos;i--)handler.end&&handler.end(stack[i]);stack.length=pos}}var index,chars,match,stack=[],last=html;for(stack.last=function(){return stack[stack.length-1]};html;){if(chars=!0,stack.last()&&specialElements[stack.last()])html=html.replace(new RegExp("(.*)<\\s*\\/\\s*"+stack.last()+"[^>]*>","i"),function(all,text){return text=text.replace(COMMENT_REGEXP,"$1").replace(CDATA_REGEXP,"$1"),handler.chars&&handler.chars(decodeEntities(text)),""}),parseEndTag("",stack.last());else if(0===html.indexOf("<!--")?(index=html.indexOf("--",4),index>=0&&html.lastIndexOf("-->",index)===index&&(handler.comment&&handler.comment(html.substring(4,index)),html=html.substring(index+3),chars=!1)):DOCTYPE_REGEXP.test(html)?(match=html.match(DOCTYPE_REGEXP),match&&(html=html.replace(match[0],""),chars=!1)):BEGING_END_TAGE_REGEXP.test(html)?(match=html.match(END_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(END_TAG_REGEXP,parseEndTag),chars=!1)):BEGIN_TAG_REGEXP.test(html)&&(match=html.match(START_TAG_REGEXP),match&&(html=html.substring(match[0].length),match[0].replace(START_TAG_REGEXP,parseStartTag),chars=!1)),chars){index=html.indexOf("<");var text=0>index?html:html.substring(0,index);html=0>index?"":html.substring(index),handler.chars&&handler.chars(decodeEntities(text))}if(html==last)throw $sanitizeMinErr("badparse","The sanitizer was unable to parse the following block of html: {0}",html);last=html}parseEndTag()}function decodeEntities(value){if(!value)return"";var parts=spaceRe.exec(value),spaceBefore=parts[1],spaceAfter=parts[3],content=parts[2];return content&&(hiddenPre.innerHTML=content.replace(/</g,"&lt;"),content="textContent"in hiddenPre?hiddenPre.textContent:hiddenPre.innerText),spaceBefore+content+spaceAfter}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function htmlSanitizeWriter(buf,uriValidator){var ignore=!1,out=angular.bind(buf,buf.push);return{start:function(tag,attrs,unary){tag=angular.lowercase(tag),!ignore&&specialElements[tag]&&(ignore=tag),ignore||validElements[tag]!==!0||(out("<"),out(tag),angular.forEach(attrs,function(value,key){var lkey=angular.lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;validAttrs[lkey]!==!0||uriAttrs[lkey]===!0&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(unary?"/>":">"))},end:function(tag){tag=angular.lowercase(tag),ignore||validElements[tag]!==!0||(out("</"),out(tag),out(">")),tag==ignore&&(ignore=!1)},chars:function(chars){ignore||out(encodeEntities(chars))}}}var $sanitizeMinErr=angular.$$minErr("$sanitize"),START_TAG_REGEXP=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,END_TAG_REGEXP=/^<\s*\/\s*([\w:-]+)[^>]*>/,ATTR_REGEXP=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,BEGIN_TAG_REGEXP=/^</,BEGING_END_TAGE_REGEXP=/^<\s*\//,COMMENT_REGEXP=/<!--(.*?)-->/g,DOCTYPE_REGEXP=/<!DOCTYPE([^>]*?)>/i,CDATA_REGEXP=/<!\[CDATA\[(.*?)]]>/g,SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^\#-~| |!])/g,voidElements=makeMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=makeMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=makeMap("rp,rt"),optionalEndTagElements=angular.extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=angular.extend({},optionalEndTagBlockElements,makeMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),inlineElements=angular.extend({},optionalEndTagInlineElements,makeMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),specialElements=makeMap("script,style"),validElements=angular.extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=makeMap("background,cite,href,longdesc,src,usemap"),validAttrs=angular.extend({},uriAttrs,makeMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),hiddenPre=document.createElement("pre"),spaceRe=/^(\s*)([\s\S]*?)(\s*)$/;angular.module("ngSanitize",[]).provider("$sanitize",$SanitizeProvider),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,MAILTO_REGEXP=/^mailto:/;return function(text,target){function addText(text){text&&html.push(sanitizeText(text))}function addLink(url,text){html.push("<a "),angular.isDefined(target)&&(html.push('target="'),html.push(target),html.push('" ')),html.push('href="'),html.push(url),html.push('">'),addText(text),html.push("</a>")}if(!text)return text;for(var match,url,i,raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]==match[3]&&(url="mailto:"+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""))}}])}(window,window.angular),define("libs/angular-sanitize-1.2.17",function(){}),function(){define("libs",["moment","libs/angular-autocomplete/angular-autocomplete","libs/ui-bootstrap","libs/ng-context-menu-0.1.4","libs/underscore-1.3.3","libs/algolia-2.5.2","libs/jquery.storage","libs/fineuploader","libs/angular-sanitize-1.2.17"],function(){})}.call(this);